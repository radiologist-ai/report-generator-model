03-09 08:27:09-INFO:Logging Dir: results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 08:27:09-INFO:Visual Extractor:resnet101   d_vf: 2048
03-09 08:27:09-INFO:==>> Set GPU devices: 0
03-09 08:27:09-INFO:Namespace(image_dir='data/iu/images/iu_2image/images/', ann_path='data/iu/images/iu_2image/annotation.json', label_path='data/iu/r2gen_split/id_label.csv', image_size=256, crop_size=224, dataset_name='iu_xray', max_seq_length=60, threshold=3, num_workers=4, batch_size=16, version='12', visual_extractor='resnet101', visual_extractor_pretrained=True, pretrain_cnn_file=None, d_model=512, d_ff=512, d_vf=2048, num_heads=8, num_memory_heads=8, num_layers=3, num_labels=14, dropout=0.1, logit_layers=1, bos_idx=0, eos_idx=0, pad_idx=0, use_bn=0, drop_prob_lm=0.1, sample_method='beam_search', beam_size=3, temperature=1.0, sample_n=1, group_size=1, output_logsoftmax=1, decoding_constraint=0, block_trigrams=1, n_gpu=1, epochs=50, save_dir='results\\iu_xray\\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709', expe_name='7th_try', record_dir='records/', save_period=1, monitor_mode='max', monitor_metric='BLEU_4', early_stop=50, label_smoothing=0.0, alpha=0.5, grad_clip=5, test_steps=0, label_loss=True, rank_loss=True, optim='Adam', lr_ve=5e-05, lr_ed=0.0001, weight_decay=5e-05, amsgrad=True, lr_scheduler='StepLR', step_size=50, gamma=0.1, seed=9223, gpu='0', resume=None, num_slots=60, rm_num_heads=8, rm_d_model=512, cfg='config/iu_resnet.yml', set_cfgs=[])
03-09 08:27:09-INFO:Model name: LAMRGModel_v12 	Model Layers:3
03-09 08:27:12-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 08:29:39-INFO:Epoch [1/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 08:29:39-INFO:VAL ||| Epoch: 1|||train_loss: 5.531||| BLEU_1: 0.1389 |||BLEU_2: 0.09218 |||BLEU_3: 0.06113 |||BLEU_4: 0.04295 |||CIDEr: 0.06655 |||ROUGE_L: 0.2854
03-09 08:29:39-INFO:TEST || Epoch: 1|||train_loss: 5.531||| BLEU_1: 0.1123 |||BLEU_2: 0.07316 |||BLEU_3: 0.04844 |||BLEU_4: 0.03349 |||CIDEr: 0.06881 |||ROUGE_L: 0.2681
03-09 08:29:52-INFO:Saving current best: model_best.pth ...
03-09 08:29:52-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 08:32:10-INFO:Epoch [2/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 08:32:10-INFO:VAL ||| Epoch: 2|||train_loss: 4.195||| BLEU_1: 0.2922 |||BLEU_2: 0.1973 |||BLEU_3: 0.1403 |||BLEU_4: 0.1075 |||CIDEr: 0.2085 |||ROUGE_L: 0.3206
03-09 08:32:10-INFO:TEST || Epoch: 2|||train_loss: 4.195||| BLEU_1: 0.2663 |||BLEU_2: 0.1781 |||BLEU_3: 0.1266 |||BLEU_4: 0.09717 |||CIDEr: 0.1969 |||ROUGE_L: 0.3083
03-09 08:32:24-INFO:Saving current best: model_best.pth ...
03-09 08:32:24-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 08:34:42-INFO:Epoch [3/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 08:34:42-INFO:VAL ||| Epoch: 3|||train_loss: 3.68||| BLEU_1: 0.3729 |||BLEU_2: 0.2189 |||BLEU_3: 0.148 |||BLEU_4: 0.1052 |||CIDEr: 0.1768 |||ROUGE_L: 0.3313
03-09 08:34:42-INFO:TEST || Epoch: 3|||train_loss: 3.68||| BLEU_1: 0.3517 |||BLEU_2: 0.2037 |||BLEU_3: 0.1364 |||BLEU_4: 0.09645 |||CIDEr: 0.1565 |||ROUGE_L: 0.3199
03-09 08:34:47-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 08:37:02-INFO:Epoch [4/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 08:37:02-INFO:VAL ||| Epoch: 4|||train_loss: 3.328||| BLEU_1: 0.4068 |||BLEU_2: 0.2579 |||BLEU_3: 0.1833 |||BLEU_4: 0.1347 |||CIDEr: 0.2507 |||ROUGE_L: 0.3489
03-09 08:37:02-INFO:TEST || Epoch: 4|||train_loss: 3.328||| BLEU_1: 0.3865 |||BLEU_2: 0.2386 |||BLEU_3: 0.1665 |||BLEU_4: 0.1212 |||CIDEr: 0.2008 |||ROUGE_L: 0.3382
03-09 08:37:14-INFO:Saving current best: model_best.pth ...
03-09 08:37:14-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 08:39:29-INFO:Epoch [5/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 08:39:29-INFO:VAL ||| Epoch: 5|||train_loss: 3.057||| BLEU_1: 0.4319 |||BLEU_2: 0.2841 |||BLEU_3: 0.1992 |||BLEU_4: 0.1485 |||CIDEr: 0.2374 |||ROUGE_L: 0.3405
03-09 08:39:29-INFO:TEST || Epoch: 5|||train_loss: 3.057||| BLEU_1: 0.4327 |||BLEU_2: 0.2774 |||BLEU_3: 0.191 |||BLEU_4: 0.1387 |||CIDEr: 0.2009 |||ROUGE_L: 0.3296
03-09 08:39:43-INFO:Saving current best: model_best.pth ...
03-09 08:39:43-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 08:42:00-INFO:Epoch [6/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 08:42:00-INFO:VAL ||| Epoch: 6|||train_loss: 2.841||| BLEU_1: 0.4406 |||BLEU_2: 0.2903 |||BLEU_3: 0.207 |||BLEU_4: 0.1583 |||CIDEr: 0.3576 |||ROUGE_L: 0.3367
03-09 08:42:00-INFO:TEST || Epoch: 6|||train_loss: 2.841||| BLEU_1: 0.413 |||BLEU_2: 0.2714 |||BLEU_3: 0.1933 |||BLEU_4: 0.1473 |||CIDEr: 0.2125 |||ROUGE_L: 0.3274
03-09 08:42:13-INFO:Saving current best: model_best.pth ...
03-09 08:42:13-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 08:44:27-INFO:Epoch [7/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 08:44:27-INFO:VAL ||| Epoch: 7|||train_loss: 2.698||| BLEU_1: 0.4556 |||BLEU_2: 0.2982 |||BLEU_3: 0.2108 |||BLEU_4: 0.1601 |||CIDEr: 0.303 |||ROUGE_L: 0.3355
03-09 08:44:27-INFO:TEST || Epoch: 7|||train_loss: 2.698||| BLEU_1: 0.4472 |||BLEU_2: 0.2903 |||BLEU_3: 0.2044 |||BLEU_4: 0.1539 |||CIDEr: 0.1982 |||ROUGE_L: 0.329
03-09 08:44:40-INFO:Saving current best: model_best.pth ...
03-09 08:44:40-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 08:46:56-INFO:Epoch [8/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 08:46:56-INFO:VAL ||| Epoch: 8|||train_loss: 2.573||| BLEU_1: 0.4396 |||BLEU_2: 0.2896 |||BLEU_3: 0.2065 |||BLEU_4: 0.158 |||CIDEr: 0.357 |||ROUGE_L: 0.3374
03-09 08:46:56-INFO:TEST || Epoch: 8|||train_loss: 2.573||| BLEU_1: 0.4127 |||BLEU_2: 0.2713 |||BLEU_3: 0.1932 |||BLEU_4: 0.1472 |||CIDEr: 0.2138 |||ROUGE_L: 0.3278
03-09 08:47:01-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 08:49:15-INFO:Epoch [9/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 08:49:15-INFO:VAL ||| Epoch: 9|||train_loss: 2.483||| BLEU_1: 0.4173 |||BLEU_2: 0.2702 |||BLEU_3: 0.1914 |||BLEU_4: 0.1474 |||CIDEr: 0.3703 |||ROUGE_L: 0.3372
03-09 08:49:15-INFO:TEST || Epoch: 9|||train_loss: 2.483||| BLEU_1: 0.39 |||BLEU_2: 0.2518 |||BLEU_3: 0.178 |||BLEU_4: 0.1365 |||CIDEr: 0.2362 |||ROUGE_L: 0.3283
03-09 08:49:19-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 08:51:34-INFO:Epoch [10/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 08:51:34-INFO:VAL ||| Epoch: 10|||train_loss: 2.383||| BLEU_1: 0.4326 |||BLEU_2: 0.2768 |||BLEU_3: 0.1952 |||BLEU_4: 0.1498 |||CIDEr: 0.3326 |||ROUGE_L: 0.3346
03-09 08:51:34-INFO:TEST || Epoch: 10|||train_loss: 2.383||| BLEU_1: 0.4054 |||BLEU_2: 0.2579 |||BLEU_3: 0.1814 |||BLEU_4: 0.1386 |||CIDEr: 0.2011 |||ROUGE_L: 0.3253
03-09 08:51:39-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 08:53:54-INFO:Epoch [11/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 08:53:54-INFO:VAL ||| Epoch: 11|||train_loss: 2.293||| BLEU_1: 0.4397 |||BLEU_2: 0.2893 |||BLEU_3: 0.206 |||BLEU_4: 0.1576 |||CIDEr: 0.356 |||ROUGE_L: 0.3372
03-09 08:53:54-INFO:TEST || Epoch: 11|||train_loss: 2.293||| BLEU_1: 0.4128 |||BLEU_2: 0.2711 |||BLEU_3: 0.1931 |||BLEU_4: 0.1471 |||CIDEr: 0.2127 |||ROUGE_L: 0.3278
03-09 08:53:58-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 08:56:09-INFO:Epoch [12/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 08:56:09-INFO:VAL ||| Epoch: 12|||train_loss: 2.21||| BLEU_1: 0.449 |||BLEU_2: 0.2902 |||BLEU_3: 0.2024 |||BLEU_4: 0.1537 |||CIDEr: 0.2922 |||ROUGE_L: 0.3364
03-09 08:56:09-INFO:TEST || Epoch: 12|||train_loss: 2.21||| BLEU_1: 0.4366 |||BLEU_2: 0.283 |||BLEU_3: 0.1978 |||BLEU_4: 0.1493 |||CIDEr: 0.2 |||ROUGE_L: 0.3341
03-09 08:56:14-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 08:58:25-INFO:Epoch [13/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 08:58:25-INFO:VAL ||| Epoch: 13|||train_loss: 2.154||| BLEU_1: 0.4404 |||BLEU_2: 0.2821 |||BLEU_3: 0.197 |||BLEU_4: 0.1512 |||CIDEr: 0.3353 |||ROUGE_L: 0.3339
03-09 08:58:25-INFO:TEST || Epoch: 13|||train_loss: 2.154||| BLEU_1: 0.4219 |||BLEU_2: 0.2718 |||BLEU_3: 0.1898 |||BLEU_4: 0.1441 |||CIDEr: 0.2051 |||ROUGE_L: 0.3309
03-09 08:58:29-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 09:00:40-INFO:Epoch [14/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 09:00:40-INFO:VAL ||| Epoch: 14|||train_loss: 2.069||| BLEU_1: 0.4476 |||BLEU_2: 0.2891 |||BLEU_3: 0.2016 |||BLEU_4: 0.153 |||CIDEr: 0.2923 |||ROUGE_L: 0.3358
03-09 09:00:40-INFO:TEST || Epoch: 14|||train_loss: 2.069||| BLEU_1: 0.438 |||BLEU_2: 0.2836 |||BLEU_3: 0.198 |||BLEU_4: 0.1494 |||CIDEr: 0.2035 |||ROUGE_L: 0.3335
03-09 09:00:44-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 09:02:55-INFO:Epoch [15/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 09:02:55-INFO:VAL ||| Epoch: 15|||train_loss: 2.013||| BLEU_1: 0.425 |||BLEU_2: 0.2697 |||BLEU_3: 0.1871 |||BLEU_4: 0.1427 |||CIDEr: 0.2005 |||ROUGE_L: 0.3264
03-09 09:02:55-INFO:TEST || Epoch: 15|||train_loss: 2.013||| BLEU_1: 0.432 |||BLEU_2: 0.2752 |||BLEU_3: 0.1906 |||BLEU_4: 0.1439 |||CIDEr: 0.1722 |||ROUGE_L: 0.3273
03-09 09:02:59-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 09:05:10-INFO:Epoch [16/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 09:05:10-INFO:VAL ||| Epoch: 16|||train_loss: 1.946||| BLEU_1: 0.4378 |||BLEU_2: 0.28 |||BLEU_3: 0.1938 |||BLEU_4: 0.1472 |||CIDEr: 0.2692 |||ROUGE_L: 0.3309
03-09 09:05:10-INFO:TEST || Epoch: 16|||train_loss: 1.946||| BLEU_1: 0.4434 |||BLEU_2: 0.285 |||BLEU_3: 0.1969 |||BLEU_4: 0.1478 |||CIDEr: 0.206 |||ROUGE_L: 0.3303
03-09 09:05:14-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 09:07:25-INFO:Epoch [17/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 09:07:25-INFO:VAL ||| Epoch: 17|||train_loss: 1.898||| BLEU_1: 0.4219 |||BLEU_2: 0.2692 |||BLEU_3: 0.1857 |||BLEU_4: 0.1403 |||CIDEr: 0.2216 |||ROUGE_L: 0.3281
03-09 09:07:25-INFO:TEST || Epoch: 17|||train_loss: 1.898||| BLEU_1: 0.4308 |||BLEU_2: 0.2756 |||BLEU_3: 0.1898 |||BLEU_4: 0.1423 |||CIDEr: 0.1971 |||ROUGE_L: 0.331
03-09 09:07:29-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 09:09:39-INFO:Epoch [18/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 09:09:39-INFO:VAL ||| Epoch: 18|||train_loss: 1.83||| BLEU_1: 0.4156 |||BLEU_2: 0.2688 |||BLEU_3: 0.1872 |||BLEU_4: 0.1411 |||CIDEr: 0.1981 |||ROUGE_L: 0.3253
03-09 09:09:39-INFO:TEST || Epoch: 18|||train_loss: 1.83||| BLEU_1: 0.4267 |||BLEU_2: 0.2763 |||BLEU_3: 0.1916 |||BLEU_4: 0.1427 |||CIDEr: 0.2221 |||ROUGE_L: 0.328
03-09 09:09:44-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 09:11:54-INFO:Epoch [19/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 09:11:54-INFO:VAL ||| Epoch: 19|||train_loss: 1.772||| BLEU_1: 0.4009 |||BLEU_2: 0.2507 |||BLEU_3: 0.1731 |||BLEU_4: 0.132 |||CIDEr: 0.1639 |||ROUGE_L: 0.3168
03-09 09:11:54-INFO:TEST || Epoch: 19|||train_loss: 1.772||| BLEU_1: 0.4135 |||BLEU_2: 0.2602 |||BLEU_3: 0.1794 |||BLEU_4: 0.1352 |||CIDEr: 0.1693 |||ROUGE_L: 0.3206
03-09 09:11:58-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 09:14:08-INFO:Epoch [20/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 09:14:08-INFO:VAL ||| Epoch: 20|||train_loss: 1.712||| BLEU_1: 0.4093 |||BLEU_2: 0.2617 |||BLEU_3: 0.1814 |||BLEU_4: 0.1373 |||CIDEr: 0.1865 |||ROUGE_L: 0.3233
03-09 09:14:08-INFO:TEST || Epoch: 20|||train_loss: 1.712||| BLEU_1: 0.4198 |||BLEU_2: 0.2677 |||BLEU_3: 0.1845 |||BLEU_4: 0.1382 |||CIDEr: 0.2071 |||ROUGE_L: 0.3235
03-09 09:14:12-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 09:16:23-INFO:Epoch [21/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 09:16:23-INFO:VAL ||| Epoch: 21|||train_loss: 1.676||| BLEU_1: 0.3984 |||BLEU_2: 0.2478 |||BLEU_3: 0.1699 |||BLEU_4: 0.1288 |||CIDEr: 0.1663 |||ROUGE_L: 0.3174
03-09 09:16:23-INFO:TEST || Epoch: 21|||train_loss: 1.676||| BLEU_1: 0.409 |||BLEU_2: 0.2543 |||BLEU_3: 0.1735 |||BLEU_4: 0.1299 |||CIDEr: 0.1912 |||ROUGE_L: 0.3197
03-09 09:16:27-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 09:18:37-INFO:Epoch [22/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 09:18:37-INFO:VAL ||| Epoch: 22|||train_loss: 1.61||| BLEU_1: 0.4005 |||BLEU_2: 0.2504 |||BLEU_3: 0.1727 |||BLEU_4: 0.1316 |||CIDEr: 0.1629 |||ROUGE_L: 0.3164
03-09 09:18:37-INFO:TEST || Epoch: 22|||train_loss: 1.61||| BLEU_1: 0.4113 |||BLEU_2: 0.2586 |||BLEU_3: 0.1782 |||BLEU_4: 0.1342 |||CIDEr: 0.1687 |||ROUGE_L: 0.3201
03-09 09:18:42-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 09:20:59-INFO:Epoch [23/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 09:20:59-INFO:VAL ||| Epoch: 23|||train_loss: 1.557||| BLEU_1: 0.4142 |||BLEU_2: 0.2582 |||BLEU_3: 0.178 |||BLEU_4: 0.1354 |||CIDEr: 0.1855 |||ROUGE_L: 0.3188
03-09 09:20:59-INFO:TEST || Epoch: 23|||train_loss: 1.557||| BLEU_1: 0.4265 |||BLEU_2: 0.2674 |||BLEU_3: 0.1839 |||BLEU_4: 0.1383 |||CIDEr: 0.1848 |||ROUGE_L: 0.3217
03-09 09:21:03-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 09:23:21-INFO:Epoch [24/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 09:23:21-INFO:VAL ||| Epoch: 24|||train_loss: 1.52||| BLEU_1: 0.4048 |||BLEU_2: 0.2543 |||BLEU_3: 0.1754 |||BLEU_4: 0.1333 |||CIDEr: 0.1726 |||ROUGE_L: 0.3186
03-09 09:23:21-INFO:TEST || Epoch: 24|||train_loss: 1.52||| BLEU_1: 0.4154 |||BLEU_2: 0.2625 |||BLEU_3: 0.181 |||BLEU_4: 0.1363 |||CIDEr: 0.1739 |||ROUGE_L: 0.323
03-09 09:23:25-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 09:25:43-INFO:Epoch [25/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 09:25:43-INFO:VAL ||| Epoch: 25|||train_loss: 1.463||| BLEU_1: 0.4015 |||BLEU_2: 0.2511 |||BLEU_3: 0.1734 |||BLEU_4: 0.1322 |||CIDEr: 0.1645 |||ROUGE_L: 0.317
03-09 09:25:43-INFO:TEST || Epoch: 25|||train_loss: 1.463||| BLEU_1: 0.4134 |||BLEU_2: 0.2599 |||BLEU_3: 0.1791 |||BLEU_4: 0.135 |||CIDEr: 0.1694 |||ROUGE_L: 0.3208
03-09 09:25:48-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 09:28:06-INFO:Epoch [26/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 09:28:06-INFO:VAL ||| Epoch: 26|||train_loss: 1.407||| BLEU_1: 0.4469 |||BLEU_2: 0.2838 |||BLEU_3: 0.1972 |||BLEU_4: 0.1509 |||CIDEr: 0.2976 |||ROUGE_L: 0.3298
03-09 09:28:06-INFO:TEST || Epoch: 26|||train_loss: 1.407||| BLEU_1: 0.4315 |||BLEU_2: 0.2763 |||BLEU_3: 0.192 |||BLEU_4: 0.1454 |||CIDEr: 0.2008 |||ROUGE_L: 0.3301
03-09 09:28:11-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 09:30:28-INFO:Epoch [27/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 09:30:28-INFO:VAL ||| Epoch: 27|||train_loss: 1.371||| BLEU_1: 0.4391 |||BLEU_2: 0.2779 |||BLEU_3: 0.193 |||BLEU_4: 0.1477 |||CIDEr: 0.3154 |||ROUGE_L: 0.3293
03-09 09:30:28-INFO:TEST || Epoch: 27|||train_loss: 1.371||| BLEU_1: 0.4352 |||BLEU_2: 0.2774 |||BLEU_3: 0.1923 |||BLEU_4: 0.1455 |||CIDEr: 0.1823 |||ROUGE_L: 0.3272
03-09 09:30:32-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 09:32:50-INFO:Epoch [28/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 09:32:50-INFO:VAL ||| Epoch: 28|||train_loss: 1.318||| BLEU_1: 0.3948 |||BLEU_2: 0.2498 |||BLEU_3: 0.1738 |||BLEU_4: 0.1328 |||CIDEr: 0.1688 |||ROUGE_L: 0.3179
03-09 09:32:50-INFO:TEST || Epoch: 28|||train_loss: 1.318||| BLEU_1: 0.4101 |||BLEU_2: 0.2604 |||BLEU_3: 0.1807 |||BLEU_4: 0.1366 |||CIDEr: 0.1722 |||ROUGE_L: 0.3205
03-09 09:32:55-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 09:35:10-INFO:Epoch [29/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 09:35:10-INFO:VAL ||| Epoch: 29|||train_loss: 1.276||| BLEU_1: 0.4377 |||BLEU_2: 0.2803 |||BLEU_3: 0.1958 |||BLEU_4: 0.1503 |||CIDEr: 0.3364 |||ROUGE_L: 0.3329
03-09 09:35:10-INFO:TEST || Epoch: 29|||train_loss: 1.276||| BLEU_1: 0.4201 |||BLEU_2: 0.2712 |||BLEU_3: 0.1895 |||BLEU_4: 0.1439 |||CIDEr: 0.2092 |||ROUGE_L: 0.3314
03-09 09:35:15-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 09:37:32-INFO:Epoch [30/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 09:37:32-INFO:VAL ||| Epoch: 30|||train_loss: 1.242||| BLEU_1: 0.3618 |||BLEU_2: 0.2285 |||BLEU_3: 0.156 |||BLEU_4: 0.1108 |||CIDEr: 0.1497 |||ROUGE_L: 0.2962
03-09 09:37:32-INFO:TEST || Epoch: 30|||train_loss: 1.242||| BLEU_1: 0.369 |||BLEU_2: 0.2328 |||BLEU_3: 0.1603 |||BLEU_4: 0.1171 |||CIDEr: 0.1611 |||ROUGE_L: 0.2934
03-09 09:37:36-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 09:39:55-INFO:Epoch [31/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 09:39:55-INFO:VAL ||| Epoch: 31|||train_loss: 1.204||| BLEU_1: 0.3518 |||BLEU_2: 0.2085 |||BLEU_3: 0.1364 |||BLEU_4: 0.09766 |||CIDEr: 0.1745 |||ROUGE_L: 0.2818
03-09 09:39:55-INFO:TEST || Epoch: 31|||train_loss: 1.204||| BLEU_1: 0.3556 |||BLEU_2: 0.2097 |||BLEU_3: 0.135 |||BLEU_4: 0.09196 |||CIDEr: 0.1253 |||ROUGE_L: 0.2699
03-09 09:39:59-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 09:42:17-INFO:Epoch [32/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 09:42:17-INFO:VAL ||| Epoch: 32|||train_loss: 1.145||| BLEU_1: 0.3434 |||BLEU_2: 0.2115 |||BLEU_3: 0.1392 |||BLEU_4: 0.09104 |||CIDEr: 0.152 |||ROUGE_L: 0.2837
03-09 09:42:17-INFO:TEST || Epoch: 32|||train_loss: 1.145||| BLEU_1: 0.337 |||BLEU_2: 0.2 |||BLEU_3: 0.126 |||BLEU_4: 0.07693 |||CIDEr: 0.1092 |||ROUGE_L: 0.2694
03-09 09:42:22-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 09:44:39-INFO:Epoch [33/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 09:44:39-INFO:VAL ||| Epoch: 33|||train_loss: 1.112||| BLEU_1: 0.3656 |||BLEU_2: 0.2077 |||BLEU_3: 0.1313 |||BLEU_4: 0.08466 |||CIDEr: 0.1326 |||ROUGE_L: 0.2844
03-09 09:44:39-INFO:TEST || Epoch: 33|||train_loss: 1.112||| BLEU_1: 0.3688 |||BLEU_2: 0.2139 |||BLEU_3: 0.1374 |||BLEU_4: 0.09213 |||CIDEr: 0.1686 |||ROUGE_L: 0.2829
03-09 09:44:44-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 09:47:00-INFO:Epoch [34/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 09:47:00-INFO:VAL ||| Epoch: 34|||train_loss: 1.084||| BLEU_1: 0.3526 |||BLEU_2: 0.2131 |||BLEU_3: 0.1401 |||BLEU_4: 0.09686 |||CIDEr: 0.1163 |||ROUGE_L: 0.2899
03-09 09:47:00-INFO:TEST || Epoch: 34|||train_loss: 1.084||| BLEU_1: 0.3582 |||BLEU_2: 0.2161 |||BLEU_3: 0.1421 |||BLEU_4: 0.09944 |||CIDEr: 0.1504 |||ROUGE_L: 0.2919
03-09 09:47:05-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 09:49:25-INFO:Epoch [35/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 09:49:25-INFO:VAL ||| Epoch: 35|||train_loss: 1.045||| BLEU_1: 0.3621 |||BLEU_2: 0.2177 |||BLEU_3: 0.1456 |||BLEU_4: 0.1082 |||CIDEr: 0.1317 |||ROUGE_L: 0.2895
03-09 09:49:25-INFO:TEST || Epoch: 35|||train_loss: 1.045||| BLEU_1: 0.3643 |||BLEU_2: 0.2206 |||BLEU_3: 0.1498 |||BLEU_4: 0.1113 |||CIDEr: 0.1852 |||ROUGE_L: 0.2888
03-09 09:49:29-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 09:51:50-INFO:Epoch [36/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 09:51:50-INFO:VAL ||| Epoch: 36|||train_loss: 1.008||| BLEU_1: 0.2857 |||BLEU_2: 0.1344 |||BLEU_3: 0.07203 |||BLEU_4: 0.04263 |||CIDEr: 0.0609 |||ROUGE_L: 0.2336
03-09 09:51:50-INFO:TEST || Epoch: 36|||train_loss: 1.008||| BLEU_1: 0.2803 |||BLEU_2: 0.1269 |||BLEU_3: 0.06702 |||BLEU_4: 0.03713 |||CIDEr: 0.04884 |||ROUGE_L: 0.2287
03-09 09:51:55-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 09:54:15-INFO:Epoch [37/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 09:54:15-INFO:VAL ||| Epoch: 37|||train_loss: 0.9693||| BLEU_1: 0.3265 |||BLEU_2: 0.1647 |||BLEU_3: 0.08874 |||BLEU_4: 0.05377 |||CIDEr: 0.1146 |||ROUGE_L: 0.244
03-09 09:54:15-INFO:TEST || Epoch: 37|||train_loss: 0.9693||| BLEU_1: 0.3195 |||BLEU_2: 0.1542 |||BLEU_3: 0.07947 |||BLEU_4: 0.04292 |||CIDEr: 0.08464 |||ROUGE_L: 0.2385
03-09 09:54:20-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 09:56:42-INFO:Epoch [38/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 09:56:42-INFO:VAL ||| Epoch: 38|||train_loss: 0.9516||| BLEU_1: 0.3702 |||BLEU_2: 0.2213 |||BLEU_3: 0.148 |||BLEU_4: 0.11 |||CIDEr: 0.1566 |||ROUGE_L: 0.2907
03-09 09:56:42-INFO:TEST || Epoch: 38|||train_loss: 0.9516||| BLEU_1: 0.3687 |||BLEU_2: 0.2188 |||BLEU_3: 0.147 |||BLEU_4: 0.1087 |||CIDEr: 0.1713 |||ROUGE_L: 0.2831
03-09 09:56:47-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 09:59:10-INFO:Epoch [39/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 09:59:10-INFO:VAL ||| Epoch: 39|||train_loss: 0.92||| BLEU_1: 0.3467 |||BLEU_2: 0.2112 |||BLEU_3: 0.1368 |||BLEU_4: 0.08884 |||CIDEr: 0.134 |||ROUGE_L: 0.2875
03-09 09:59:10-INFO:TEST || Epoch: 39|||train_loss: 0.92||| BLEU_1: 0.3479 |||BLEU_2: 0.2063 |||BLEU_3: 0.131 |||BLEU_4: 0.08404 |||CIDEr: 0.1276 |||ROUGE_L: 0.2801
03-09 09:59:14-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 10:01:36-INFO:Epoch [40/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 10:01:36-INFO:VAL ||| Epoch: 40|||train_loss: 0.8735||| BLEU_1: 0.353 |||BLEU_2: 0.2137 |||BLEU_3: 0.139 |||BLEU_4: 0.0915 |||CIDEr: 0.1481 |||ROUGE_L: 0.2809
03-09 10:01:36-INFO:TEST || Epoch: 40|||train_loss: 0.8735||| BLEU_1: 0.35 |||BLEU_2: 0.2071 |||BLEU_3: 0.1334 |||BLEU_4: 0.08741 |||CIDEr: 0.1289 |||ROUGE_L: 0.2702
03-09 10:01:40-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 10:04:03-INFO:Epoch [41/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 10:04:03-INFO:VAL ||| Epoch: 41|||train_loss: 0.848||| BLEU_1: 0.4095 |||BLEU_2: 0.2422 |||BLEU_3: 0.1502 |||BLEU_4: 0.099 |||CIDEr: 0.1456 |||ROUGE_L: 0.3105
03-09 10:04:03-INFO:TEST || Epoch: 41|||train_loss: 0.848||| BLEU_1: 0.4124 |||BLEU_2: 0.2471 |||BLEU_3: 0.1544 |||BLEU_4: 0.1062 |||CIDEr: 0.1619 |||ROUGE_L: 0.3029
03-09 10:04:07-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 10:06:28-INFO:Epoch [42/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 10:06:28-INFO:VAL ||| Epoch: 42|||train_loss: 0.8248||| BLEU_1: 0.344 |||BLEU_2: 0.2071 |||BLEU_3: 0.1336 |||BLEU_4: 0.08466 |||CIDEr: 0.1221 |||ROUGE_L: 0.2849
03-09 10:06:28-INFO:TEST || Epoch: 42|||train_loss: 0.8248||| BLEU_1: 0.3423 |||BLEU_2: 0.1986 |||BLEU_3: 0.1238 |||BLEU_4: 0.07493 |||CIDEr: 0.1258 |||ROUGE_L: 0.2742
03-09 10:06:32-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 10:08:53-INFO:Epoch [43/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 10:08:53-INFO:VAL ||| Epoch: 43|||train_loss: 0.7945||| BLEU_1: 0.3714 |||BLEU_2: 0.2263 |||BLEU_3: 0.1512 |||BLEU_4: 0.1072 |||CIDEr: 0.1654 |||ROUGE_L: 0.2967
03-09 10:08:53-INFO:TEST || Epoch: 43|||train_loss: 0.7945||| BLEU_1: 0.3608 |||BLEU_2: 0.2175 |||BLEU_3: 0.1439 |||BLEU_4: 0.102 |||CIDEr: 0.1386 |||ROUGE_L: 0.2887
03-09 10:08:57-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 10:11:17-INFO:Epoch [44/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 10:11:17-INFO:VAL ||| Epoch: 44|||train_loss: 0.7904||| BLEU_1: 0.3714 |||BLEU_2: 0.219 |||BLEU_3: 0.1479 |||BLEU_4: 0.1112 |||CIDEr: 0.09409 |||ROUGE_L: 0.2854
03-09 10:11:17-INFO:TEST || Epoch: 44|||train_loss: 0.7904||| BLEU_1: 0.3718 |||BLEU_2: 0.2204 |||BLEU_3: 0.1491 |||BLEU_4: 0.1112 |||CIDEr: 0.1444 |||ROUGE_L: 0.286
03-09 10:11:22-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 10:13:42-INFO:Epoch [45/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 10:13:42-INFO:VAL ||| Epoch: 45|||train_loss: 0.7583||| BLEU_1: 0.3415 |||BLEU_2: 0.2039 |||BLEU_3: 0.13 |||BLEU_4: 0.08089 |||CIDEr: 0.1149 |||ROUGE_L: 0.2847
03-09 10:13:42-INFO:TEST || Epoch: 45|||train_loss: 0.7583||| BLEU_1: 0.3399 |||BLEU_2: 0.1962 |||BLEU_3: 0.1216 |||BLEU_4: 0.07325 |||CIDEr: 0.1305 |||ROUGE_L: 0.2748
03-09 10:13:46-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 10:16:10-INFO:Epoch [46/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 10:16:10-INFO:VAL ||| Epoch: 46|||train_loss: 0.7298||| BLEU_1: 0.3717 |||BLEU_2: 0.2201 |||BLEU_3: 0.149 |||BLEU_4: 0.112 |||CIDEr: 0.0983 |||ROUGE_L: 0.286
03-09 10:16:10-INFO:TEST || Epoch: 46|||train_loss: 0.7298||| BLEU_1: 0.371 |||BLEU_2: 0.221 |||BLEU_3: 0.1499 |||BLEU_4: 0.1118 |||CIDEr: 0.1447 |||ROUGE_L: 0.2865
03-09 10:16:14-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 10:18:39-INFO:Epoch [47/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 10:18:39-INFO:VAL ||| Epoch: 47|||train_loss: 0.7028||| BLEU_1: 0.3395 |||BLEU_2: 0.2072 |||BLEU_3: 0.1354 |||BLEU_4: 0.08971 |||CIDEr: 0.1196 |||ROUGE_L: 0.2743
03-09 10:18:39-INFO:TEST || Epoch: 47|||train_loss: 0.7028||| BLEU_1: 0.3386 |||BLEU_2: 0.199 |||BLEU_3: 0.1259 |||BLEU_4: 0.08146 |||CIDEr: 0.1482 |||ROUGE_L: 0.2641
03-09 10:18:44-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 10:21:08-INFO:Epoch [48/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 10:21:08-INFO:VAL ||| Epoch: 48|||train_loss: 0.6909||| BLEU_1: 0.3454 |||BLEU_2: 0.2089 |||BLEU_3: 0.1344 |||BLEU_4: 0.08534 |||CIDEr: 0.1485 |||ROUGE_L: 0.2807
03-09 10:21:08-INFO:TEST || Epoch: 48|||train_loss: 0.6909||| BLEU_1: 0.3358 |||BLEU_2: 0.1972 |||BLEU_3: 0.124 |||BLEU_4: 0.07579 |||CIDEr: 0.1177 |||ROUGE_L: 0.2675
03-09 10:21:12-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 10:23:33-INFO:Epoch [49/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 10:23:33-INFO:VAL ||| Epoch: 49|||train_loss: 0.6658||| BLEU_1: 0.3112 |||BLEU_2: 0.1875 |||BLEU_3: 0.1179 |||BLEU_4: 0.07218 |||CIDEr: 0.104 |||ROUGE_L: 0.2782
03-09 10:23:33-INFO:TEST || Epoch: 49|||train_loss: 0.6658||| BLEU_1: 0.3099 |||BLEU_2: 0.1796 |||BLEU_3: 0.1105 |||BLEU_4: 0.06612 |||CIDEr: 0.144 |||ROUGE_L: 0.2702
03-09 10:23:38-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-09 10:26:02-INFO:Epoch [50/50] - results\iu_xray\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709
03-09 10:26:02-INFO:VAL ||| Epoch: 50|||train_loss: 0.638||| BLEU_1: 0.3422 |||BLEU_2: 0.2074 |||BLEU_3: 0.1344 |||BLEU_4: 0.0842 |||CIDEr: 0.151 |||ROUGE_L: 0.2788
03-09 10:26:02-INFO:TEST || Epoch: 50|||train_loss: 0.638||| BLEU_1: 0.3345 |||BLEU_2: 0.1962 |||BLEU_3: 0.124 |||BLEU_4: 0.0758 |||CIDEr: 0.1155 |||ROUGE_L: 0.2641
03-09 10:26:07-INFO:
********************Best results********************
03-09 10:26:07-INFO:Best results (w.r.t BLEU_4) in validation set:
03-09 10:26:07-INFO:VAL ||| Epoch: 7|||train_loss: 2.698||| BLEU_1: 0.4556 |||BLEU_2: 0.2982 |||BLEU_3: 0.2108 |||BLEU_4: 0.1601 |||CIDEr: 0.303 |||ROUGE_L: 0.3355
03-09 10:26:07-INFO:TEST || Epoch: 7|||train_loss: 2.698||| BLEU_1: 0.4472 |||BLEU_2: 0.2903 |||BLEU_3: 0.2044 |||BLEU_4: 0.1539 |||CIDEr: 0.1982 |||ROUGE_L: 0.329
03-09 10:26:07-INFO:Best results (w.r.t BLEU_4) in test set:
03-09 10:26:07-INFO:VAL ||| Epoch: 7|||train_loss: 2.698||| BLEU_1: 0.4556 |||BLEU_2: 0.2982 |||BLEU_3: 0.2108 |||BLEU_4: 0.1601 |||CIDEr: 0.303 |||ROUGE_L: 0.3355
03-09 10:26:07-INFO:TEST || Epoch: 7|||train_loss: 2.698||| BLEU_1: 0.4472 |||BLEU_2: 0.2903 |||BLEU_3: 0.2044 |||BLEU_4: 0.1539 |||CIDEr: 0.1982 |||ROUGE_L: 0.329
03-09 10:26:08-INFO:Namespace(image_dir='data/iu/images/iu_2image/images/', ann_path='data/iu/images/iu_2image/annotation.json', label_path='data/iu/r2gen_split/id_label.csv', image_size=256, crop_size=224, dataset_name='iu_xray', max_seq_length=60, threshold=3, num_workers=4, batch_size=16, version='12', visual_extractor='resnet101', visual_extractor_pretrained=True, pretrain_cnn_file=None, d_model=512, d_ff=512, d_vf=2048, num_heads=8, num_memory_heads=8, num_layers=3, num_labels=14, dropout=0.1, logit_layers=1, bos_idx=0, eos_idx=0, pad_idx=0, use_bn=0, drop_prob_lm=0.1, sample_method='beam_search', beam_size=3, temperature=1.0, sample_n=1, group_size=1, output_logsoftmax=1, decoding_constraint=0, block_trigrams=1, n_gpu=1, epochs=50, save_dir='results\\iu_xray\\V12_resnet101_labelloss_rankloss_7th_try_20240309-232709', expe_name='7th_try', record_dir='records/', save_period=1, monitor_mode='max', monitor_metric='BLEU_4', early_stop=50, label_smoothing=0.0, alpha=0.5, grad_clip=5, test_steps=0, label_loss=True, rank_loss=True, optim='Adam', lr_ve=5e-05, lr_ed=0.0001, weight_decay=5e-05, amsgrad=True, lr_scheduler='StepLR', step_size=50, gamma=0.1, seed=9223, gpu='0', resume=None, num_slots=60, rm_num_heads=8, rm_d_model=512, cfg='config/iu_resnet.yml', set_cfgs=[])
