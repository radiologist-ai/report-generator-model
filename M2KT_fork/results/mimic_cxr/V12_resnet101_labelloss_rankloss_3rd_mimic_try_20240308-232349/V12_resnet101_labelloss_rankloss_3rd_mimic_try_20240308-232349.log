03-08 08:23:49-INFO:Logging Dir: results\mimic_cxr\V12_resnet101_labelloss_rankloss_3rd_mimic_try_20240308-232349
03-08 08:23:49-INFO:Visual Extractor:resnet101   d_vf: 2048
03-08 08:23:49-INFO:==>> Set GPU devices: 0
03-08 08:23:49-INFO:Namespace(image_dir='data/mimic/r2gen/images/images224/files', ann_path='data/mimic/r2gen/images/images224/annotation.json', label_path='data/mimic/finding/chexpert_labeled.csv', image_size=256, crop_size=224, dataset_name='mimic_cxr', max_seq_length=80, threshold=3, num_workers=4, batch_size=16, version='12', visual_extractor='resnet101', visual_extractor_pretrained=True, pretrain_cnn_file=None, d_model=512, d_ff=512, d_vf=2048, num_heads=8, num_memory_heads=8, num_layers=3, num_labels=14, dropout=0.1, logit_layers=1, bos_idx=0, eos_idx=0, pad_idx=0, use_bn=0, drop_prob_lm=0.1, sample_method='beam_search', beam_size=3, temperature=1.0, sample_n=1, group_size=1, output_logsoftmax=1, decoding_constraint=0, block_trigrams=1, n_gpu=1, epochs=30, save_dir='results\\mimic_cxr\\V12_resnet101_labelloss_rankloss_3rd_mimic_try_20240308-232349', expe_name='3rd_mimic_try', record_dir='records/', save_period=1, monitor_mode='max', monitor_metric='BLEU_4', early_stop=50, label_smoothing=0.1, alpha=0.5, grad_clip=5, test_steps=500, label_loss=True, rank_loss=True, optim='Adam', lr_ve=5e-05, lr_ed=0.0001, weight_decay=5e-05, amsgrad=True, lr_scheduler='StepLR', step_size=1, gamma=0.8, seed=456789, gpu='0', resume=None, num_slots=60, rm_num_heads=8, rm_d_model=512, cfg='config/mimic_resnet.yml', set_cfgs=[])
03-08 08:23:57-INFO:Model name: LAMRGModel_v12 	Model Layers:3
03-08 08:23:59-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-08 09:27:36-INFO:Epoch [1/30] - results\mimic_cxr\V12_resnet101_labelloss_rankloss_3rd_mimic_try_20240308-232349
03-08 09:27:36-INFO:VAL ||| Epoch: 1|||train_loss: 2.723||| BLEU_1: 0.2802 |||BLEU_2: 0.1378 |||BLEU_3: 0.07407 |||BLEU_4: 0.04772 |||CIDEr: 0.05543 |||ROUGE_L: 0.2108
03-08 09:27:36-INFO:TEST || Epoch: 1|||train_loss: 2.723||| BLEU_1: 0.2951 |||BLEU_2: 0.1429 |||BLEU_3: 0.07342 |||BLEU_4: 0.04545 |||CIDEr: 0.0523 |||ROUGE_L: 0.2114
03-08 09:27:52-INFO:Saving current best: model_best.pth ...
03-08 09:27:52-INFO:==>> Model lr: 8e-05, Visual Encoder lr: 4e-05
03-08 10:50:27-INFO:Epoch [2/30] - results\mimic_cxr\V12_resnet101_labelloss_rankloss_3rd_mimic_try_20240308-232349
03-08 10:50:27-INFO:VAL ||| Epoch: 2|||train_loss: 2.061||| BLEU_1: 0.2328 |||BLEU_2: 0.1234 |||BLEU_3: 0.06825 |||BLEU_4: 0.0418 |||CIDEr: 0.03685 |||ROUGE_L: 0.205
03-08 10:50:27-INFO:TEST || Epoch: 2|||train_loss: 2.061||| BLEU_1: 0.2446 |||BLEU_2: 0.1294 |||BLEU_3: 0.07068 |||BLEU_4: 0.04358 |||CIDEr: 0.05765 |||ROUGE_L: 0.2063
03-08 10:50:31-INFO:==>> Model lr: 6.4e-05, Visual Encoder lr: 3.2e-05
03-08 12:11:44-INFO:Epoch [3/30] - results\mimic_cxr\V12_resnet101_labelloss_rankloss_3rd_mimic_try_20240308-232349
03-08 12:11:44-INFO:VAL ||| Epoch: 3|||train_loss: 1.936||| BLEU_1: 0.2389 |||BLEU_2: 0.1227 |||BLEU_3: 0.06622 |||BLEU_4: 0.04131 |||CIDEr: 0.04005 |||ROUGE_L: 0.2079
03-08 12:11:44-INFO:TEST || Epoch: 3|||train_loss: 1.936||| BLEU_1: 0.2517 |||BLEU_2: 0.1296 |||BLEU_3: 0.07052 |||BLEU_4: 0.04464 |||CIDEr: 0.05597 |||ROUGE_L: 0.2082
03-08 12:11:49-INFO:==>> Model lr: 5.12e-05, Visual Encoder lr: 2.56e-05
03-08 13:26:32-INFO:Epoch [4/30] - results\mimic_cxr\V12_resnet101_labelloss_rankloss_3rd_mimic_try_20240308-232349
03-08 13:26:32-INFO:VAL ||| Epoch: 4|||train_loss: 1.868||| BLEU_1: 0.2872 |||BLEU_2: 0.1607 |||BLEU_3: 0.09542 |||BLEU_4: 0.06079 |||CIDEr: 0.05322 |||ROUGE_L: 0.2293
03-08 13:26:32-INFO:TEST || Epoch: 4|||train_loss: 1.868||| BLEU_1: 0.2957 |||BLEU_2: 0.1644 |||BLEU_3: 0.09616 |||BLEU_4: 0.06067 |||CIDEr: 0.06803 |||ROUGE_L: 0.2273
03-08 13:26:48-INFO:Saving current best: model_best.pth ...
03-08 13:26:48-INFO:==>> Model lr: 4.096e-05, Visual Encoder lr: 2.048e-05
03-08 14:43:01-INFO:Epoch [5/30] - results\mimic_cxr\V12_resnet101_labelloss_rankloss_3rd_mimic_try_20240308-232349
03-08 14:43:01-INFO:VAL ||| Epoch: 5|||train_loss: 1.824||| BLEU_1: 0.2342 |||BLEU_2: 0.1186 |||BLEU_3: 0.06475 |||BLEU_4: 0.04007 |||CIDEr: 0.04186 |||ROUGE_L: 0.2057
03-08 14:43:01-INFO:TEST || Epoch: 5|||train_loss: 1.824||| BLEU_1: 0.2476 |||BLEU_2: 0.126 |||BLEU_3: 0.06916 |||BLEU_4: 0.04325 |||CIDEr: 0.06213 |||ROUGE_L: 0.2074
03-08 14:43:07-INFO:==>> Model lr: 3.2768e-05, Visual Encoder lr: 1.6384e-05
03-08 15:57:27-INFO:Epoch [6/30] - results\mimic_cxr\V12_resnet101_labelloss_rankloss_3rd_mimic_try_20240308-232349
03-08 15:57:27-INFO:VAL ||| Epoch: 6|||train_loss: 1.793||| BLEU_1: 0.2494 |||BLEU_2: 0.1158 |||BLEU_3: 0.06053 |||BLEU_4: 0.03835 |||CIDEr: 0.03908 |||ROUGE_L: 0.1969
03-08 15:57:27-INFO:TEST || Epoch: 6|||train_loss: 1.793||| BLEU_1: 0.2623 |||BLEU_2: 0.1194 |||BLEU_3: 0.05965 |||BLEU_4: 0.03613 |||CIDEr: 0.04312 |||ROUGE_L: 0.1959
03-08 15:57:32-INFO:==>> Model lr: 2.62144e-05, Visual Encoder lr: 1.31072e-05
03-08 17:06:30-INFO:Epoch [7/30] - results\mimic_cxr\V12_resnet101_labelloss_rankloss_3rd_mimic_try_20240308-232349
03-08 17:06:30-INFO:VAL ||| Epoch: 7|||train_loss: 1.77||| BLEU_1: 0.2389 |||BLEU_2: 0.1186 |||BLEU_3: 0.06295 |||BLEU_4: 0.03852 |||CIDEr: 0.04015 |||ROUGE_L: 0.2061
03-08 17:06:30-INFO:TEST || Epoch: 7|||train_loss: 1.77||| BLEU_1: 0.2525 |||BLEU_2: 0.1258 |||BLEU_3: 0.06742 |||BLEU_4: 0.04185 |||CIDEr: 0.05593 |||ROUGE_L: 0.2076
03-08 17:06:35-INFO:==>> Model lr: 2.097152e-05, Visual Encoder lr: 1.048576e-05
03-08 18:15:33-INFO:Epoch [8/30] - results\mimic_cxr\V12_resnet101_labelloss_rankloss_3rd_mimic_try_20240308-232349
03-08 18:15:33-INFO:VAL ||| Epoch: 8|||train_loss: 1.752||| BLEU_1: 0.2347 |||BLEU_2: 0.1223 |||BLEU_3: 0.06791 |||BLEU_4: 0.04264 |||CIDEr: 0.03758 |||ROUGE_L: 0.2058
03-08 18:15:33-INFO:TEST || Epoch: 8|||train_loss: 1.752||| BLEU_1: 0.2483 |||BLEU_2: 0.1298 |||BLEU_3: 0.07215 |||BLEU_4: 0.04572 |||CIDEr: 0.04874 |||ROUGE_L: 0.207
03-08 18:15:37-INFO:==>> Model lr: 1.677722e-05, Visual Encoder lr: 8.388608e-06
03-08 19:24:59-INFO:Epoch [9/30] - results\mimic_cxr\V12_resnet101_labelloss_rankloss_3rd_mimic_try_20240308-232349
03-08 19:24:59-INFO:VAL ||| Epoch: 9|||train_loss: 1.738||| BLEU_1: 0.2389 |||BLEU_2: 0.1186 |||BLEU_3: 0.06295 |||BLEU_4: 0.03852 |||CIDEr: 0.04015 |||ROUGE_L: 0.2061
03-08 19:24:59-INFO:TEST || Epoch: 9|||train_loss: 1.738||| BLEU_1: 0.2525 |||BLEU_2: 0.1258 |||BLEU_3: 0.06742 |||BLEU_4: 0.04185 |||CIDEr: 0.05593 |||ROUGE_L: 0.2076
03-08 19:25:04-INFO:==>> Model lr: 1.342177e-05, Visual Encoder lr: 6.710886e-06
03-08 20:33:37-INFO:Epoch [10/30] - results\mimic_cxr\V12_resnet101_labelloss_rankloss_3rd_mimic_try_20240308-232349
03-08 20:33:37-INFO:VAL ||| Epoch: 10|||train_loss: 1.728||| BLEU_1: 0.2389 |||BLEU_2: 0.1186 |||BLEU_3: 0.06295 |||BLEU_4: 0.03852 |||CIDEr: 0.04015 |||ROUGE_L: 0.2061
03-08 20:33:37-INFO:TEST || Epoch: 10|||train_loss: 1.728||| BLEU_1: 0.2525 |||BLEU_2: 0.1258 |||BLEU_3: 0.06742 |||BLEU_4: 0.04185 |||CIDEr: 0.05593 |||ROUGE_L: 0.2076
03-08 20:33:42-INFO:==>> Model lr: 1.073742e-05, Visual Encoder lr: 5.368709e-06
03-08 21:42:37-INFO:Epoch [11/30] - results\mimic_cxr\V12_resnet101_labelloss_rankloss_3rd_mimic_try_20240308-232349
03-08 21:42:37-INFO:VAL ||| Epoch: 11|||train_loss: 1.72||| BLEU_1: 0.2389 |||BLEU_2: 0.1186 |||BLEU_3: 0.06295 |||BLEU_4: 0.03852 |||CIDEr: 0.04015 |||ROUGE_L: 0.2061
03-08 21:42:37-INFO:TEST || Epoch: 11|||train_loss: 1.72||| BLEU_1: 0.2525 |||BLEU_2: 0.1258 |||BLEU_3: 0.06742 |||BLEU_4: 0.04185 |||CIDEr: 0.05593 |||ROUGE_L: 0.2076
03-08 21:42:42-INFO:==>> Model lr: 8.589935e-06, Visual Encoder lr: 4.294967e-06
03-08 22:52:09-INFO:Epoch [12/30] - results\mimic_cxr\V12_resnet101_labelloss_rankloss_3rd_mimic_try_20240308-232349
03-08 22:52:09-INFO:VAL ||| Epoch: 12|||train_loss: 1.713||| BLEU_1: 0.2389 |||BLEU_2: 0.1186 |||BLEU_3: 0.06295 |||BLEU_4: 0.03852 |||CIDEr: 0.04015 |||ROUGE_L: 0.2061
03-08 22:52:09-INFO:TEST || Epoch: 12|||train_loss: 1.713||| BLEU_1: 0.2525 |||BLEU_2: 0.1258 |||BLEU_3: 0.06742 |||BLEU_4: 0.04185 |||CIDEr: 0.05593 |||ROUGE_L: 0.2076
03-08 22:52:13-INFO:==>> Model lr: 6.871948e-06, Visual Encoder lr: 3.435974e-06
03-09 00:03:10-INFO:Epoch [13/30] - results\mimic_cxr\V12_resnet101_labelloss_rankloss_3rd_mimic_try_20240308-232349
03-09 00:03:10-INFO:VAL ||| Epoch: 13|||train_loss: 1.708||| BLEU_1: 0.2389 |||BLEU_2: 0.1186 |||BLEU_3: 0.06295 |||BLEU_4: 0.03852 |||CIDEr: 0.04015 |||ROUGE_L: 0.2061
03-09 00:03:10-INFO:TEST || Epoch: 13|||train_loss: 1.708||| BLEU_1: 0.2525 |||BLEU_2: 0.1258 |||BLEU_3: 0.06742 |||BLEU_4: 0.04185 |||CIDEr: 0.05593 |||ROUGE_L: 0.2076
03-09 00:03:15-INFO:==>> Model lr: 5.497558e-06, Visual Encoder lr: 2.748779e-06
03-09 00:06:19-INFO:=> User Stop!
03-09 00:06:25-INFO:Saved checkpint!
03-09 00:06:25-INFO:
********************Best results********************
03-09 00:06:25-INFO:Best results (w.r.t BLEU_4) in validation set:
03-09 00:06:25-INFO:VAL ||| Epoch: 4|||train_loss: 1.868||| BLEU_1: 0.2872 |||BLEU_2: 0.1607 |||BLEU_3: 0.09542 |||BLEU_4: 0.06079 |||CIDEr: 0.05322 |||ROUGE_L: 0.2293
03-09 00:06:25-INFO:TEST || Epoch: 4|||train_loss: 1.868||| BLEU_1: 0.2957 |||BLEU_2: 0.1644 |||BLEU_3: 0.09616 |||BLEU_4: 0.06067 |||CIDEr: 0.06803 |||ROUGE_L: 0.2273
03-09 00:06:25-INFO:Best results (w.r.t BLEU_4) in test set:
03-09 00:06:25-INFO:VAL ||| Epoch: 4|||train_loss: 1.868||| BLEU_1: 0.2872 |||BLEU_2: 0.1607 |||BLEU_3: 0.09542 |||BLEU_4: 0.06079 |||CIDEr: 0.05322 |||ROUGE_L: 0.2293
03-09 00:06:25-INFO:TEST || Epoch: 4|||train_loss: 1.868||| BLEU_1: 0.2957 |||BLEU_2: 0.1644 |||BLEU_3: 0.09616 |||BLEU_4: 0.06067 |||CIDEr: 0.06803 |||ROUGE_L: 0.2273
03-09 00:06:25-INFO:Namespace(image_dir='data/mimic/r2gen/images/images224/files', ann_path='data/mimic/r2gen/images/images224/annotation.json', label_path='data/mimic/finding/chexpert_labeled.csv', image_size=256, crop_size=224, dataset_name='mimic_cxr', max_seq_length=80, threshold=3, num_workers=4, batch_size=16, version='12', visual_extractor='resnet101', visual_extractor_pretrained=True, pretrain_cnn_file=None, d_model=512, d_ff=512, d_vf=2048, num_heads=8, num_memory_heads=8, num_layers=3, num_labels=14, dropout=0.1, logit_layers=1, bos_idx=0, eos_idx=0, pad_idx=0, use_bn=0, drop_prob_lm=0.1, sample_method='beam_search', beam_size=3, temperature=1.0, sample_n=1, group_size=1, output_logsoftmax=1, decoding_constraint=0, block_trigrams=1, n_gpu=1, epochs=30, save_dir='results\\mimic_cxr\\V12_resnet101_labelloss_rankloss_3rd_mimic_try_20240308-232349', expe_name='3rd_mimic_try', record_dir='records/', save_period=1, monitor_mode='max', monitor_metric='BLEU_4', early_stop=50, label_smoothing=0.1, alpha=0.5, grad_clip=5, test_steps=500, label_loss=True, rank_loss=True, optim='Adam', lr_ve=5e-05, lr_ed=0.0001, weight_decay=5e-05, amsgrad=True, lr_scheduler='StepLR', step_size=1, gamma=0.8, seed=456789, gpu='0', resume=None, num_slots=60, rm_num_heads=8, rm_d_model=512, cfg='config/mimic_resnet.yml', set_cfgs=[])
