03-29 08:51:44-INFO:Logging Dir: results\mimic_cxr\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144
03-29 08:51:44-INFO:Visual Extractor:resnet101   d_vf: 2048
03-29 08:51:44-INFO:==>> Set GPU devices: 0
03-29 08:51:44-INFO:Namespace(image_dir='data/mimic/r2gen/images/images224/files', ann_path='data/mimic/r2gen/images/images224/annotation.json', label_path='data/mimic/finding/chexpert_labeled.csv', image_size=256, crop_size=224, dataset_name='mimic_cxr', max_seq_length=80, threshold=3, num_workers=4, batch_size=16, version='12', visual_extractor='resnet101', visual_extractor_pretrained=True, pretrain_cnn_file=None, d_model=512, d_ff=512, d_vf=2048, num_heads=8, num_memory_heads=8, num_layers=3, num_labels=14, dropout=0.1, logit_layers=1, bos_idx=0, eos_idx=0, pad_idx=0, use_bn=0, drop_prob_lm=0.1, sample_method='beam_search', beam_size=3, temperature=1.0, sample_n=1, group_size=1, output_logsoftmax=1, decoding_constraint=0, block_trigrams=1, n_gpu=1, epochs=30, save_dir='results\\mimic_cxr\\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144', expe_name='10th_try_balanced_train', record_dir='records/', save_period=1, monitor_mode='max', monitor_metric='BLEU_4', early_stop=50, label_smoothing=0.1, alpha=0.5, grad_clip=5, test_steps=500, label_loss=True, rank_loss=True, optim='Adam', lr_ve=5e-05, lr_ed=0.0001, weight_decay=5e-05, amsgrad=True, lr_scheduler='StepLR', step_size=1, gamma=0.8, seed=456789, gpu='0', resume=None, num_slots=60, rm_num_heads=8, rm_d_model=512, cfg='config/mimic_resnet.yml', set_cfgs=[])
03-29 08:52:01-INFO:Model name: LAMRGModel_v12 	Model Layers:3
03-29 08:52:02-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-29 10:48:05-INFO:Epoch [1/30] - results\mimic_cxr\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144
03-29 10:48:05-INFO:VAL ||| Epoch: 1|||train_loss: 2.402||| BLEU_1: 0.2615 |||BLEU_2: 0.137 |||BLEU_3: 0.07628 |||BLEU_4: 0.04734 |||CIDEr: 0.0454 |||ROUGE_L: 0.2209
03-29 10:48:05-INFO:TEST || Epoch: 1|||train_loss: 2.402||| BLEU_1: 0.2735 |||BLEU_2: 0.1419 |||BLEU_3: 0.07853 |||BLEU_4: 0.04935 |||CIDEr: 0.05552 |||ROUGE_L: 0.22
03-29 10:48:24-INFO:Saving current best: model_best.pth ...
03-29 10:48:24-INFO:==>> Model lr: 8e-05, Visual Encoder lr: 4e-05
03-29 12:45:27-INFO:Epoch [2/30] - results\mimic_cxr\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144
03-29 12:45:27-INFO:VAL ||| Epoch: 2|||train_loss: 1.81||| BLEU_1: 0.2924 |||BLEU_2: 0.1486 |||BLEU_3: 0.08382 |||BLEU_4: 0.0553 |||CIDEr: 0.06565 |||ROUGE_L: 0.2192
03-29 12:45:27-INFO:TEST || Epoch: 2|||train_loss: 1.81||| BLEU_1: 0.2984 |||BLEU_2: 0.1469 |||BLEU_3: 0.077 |||BLEU_4: 0.04779 |||CIDEr: 0.05673 |||ROUGE_L: 0.2106
03-29 12:45:46-INFO:Saving current best: model_best.pth ...
03-29 12:45:46-INFO:==>> Model lr: 6.4e-05, Visual Encoder lr: 3.2e-05
03-29 14:43:19-INFO:Epoch [3/30] - results\mimic_cxr\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144
03-29 14:43:19-INFO:VAL ||| Epoch: 3|||train_loss: 1.662||| BLEU_1: 0.2994 |||BLEU_2: 0.1612 |||BLEU_3: 0.09517 |||BLEU_4: 0.06243 |||CIDEr: 0.069 |||ROUGE_L: 0.2293
03-29 14:43:19-INFO:TEST || Epoch: 3|||train_loss: 1.662||| BLEU_1: 0.3047 |||BLEU_2: 0.1568 |||BLEU_3: 0.08694 |||BLEU_4: 0.05472 |||CIDEr: 0.05959 |||ROUGE_L: 0.219
03-29 14:43:38-INFO:Saving current best: model_best.pth ...
03-29 14:43:38-INFO:==>> Model lr: 5.12e-05, Visual Encoder lr: 2.56e-05
03-29 16:39:41-INFO:Epoch [4/30] - results\mimic_cxr\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144
03-29 16:39:41-INFO:VAL ||| Epoch: 4|||train_loss: 1.576||| BLEU_1: 0.2962 |||BLEU_2: 0.1605 |||BLEU_3: 0.09634 |||BLEU_4: 0.06338 |||CIDEr: 0.0622 |||ROUGE_L: 0.2237
03-29 16:39:41-INFO:TEST || Epoch: 4|||train_loss: 1.576||| BLEU_1: 0.3073 |||BLEU_2: 0.1631 |||BLEU_3: 0.09477 |||BLEU_4: 0.06068 |||CIDEr: 0.06452 |||ROUGE_L: 0.2197
03-29 16:39:59-INFO:Saving current best: model_best.pth ...
03-29 16:39:59-INFO:==>> Model lr: 4.096e-05, Visual Encoder lr: 2.048e-05
03-29 18:35:58-INFO:Epoch [5/30] - results\mimic_cxr\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144
03-29 18:35:58-INFO:VAL ||| Epoch: 5|||train_loss: 1.518||| BLEU_1: 0.2844 |||BLEU_2: 0.1509 |||BLEU_3: 0.08727 |||BLEU_4: 0.05563 |||CIDEr: 0.05031 |||ROUGE_L: 0.2227
03-29 18:35:58-INFO:TEST || Epoch: 5|||train_loss: 1.518||| BLEU_1: 0.2906 |||BLEU_2: 0.156 |||BLEU_3: 0.09063 |||BLEU_4: 0.05883 |||CIDEr: 0.05844 |||ROUGE_L: 0.2197
03-29 18:36:05-INFO:==>> Model lr: 3.2768e-05, Visual Encoder lr: 1.6384e-05
03-29 20:32:39-INFO:Epoch [6/30] - results\mimic_cxr\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144
03-29 20:32:39-INFO:VAL ||| Epoch: 6|||train_loss: 1.477||| BLEU_1: 0.2731 |||BLEU_2: 0.1493 |||BLEU_3: 0.0879 |||BLEU_4: 0.0568 |||CIDEr: 0.04459 |||ROUGE_L: 0.2221
03-29 20:32:39-INFO:TEST || Epoch: 6|||train_loss: 1.477||| BLEU_1: 0.2826 |||BLEU_2: 0.1552 |||BLEU_3: 0.09185 |||BLEU_4: 0.06051 |||CIDEr: 0.05791 |||ROUGE_L: 0.2189
03-29 20:32:45-INFO:==>> Model lr: 2.62144e-05, Visual Encoder lr: 1.31072e-05
03-29 21:15:52-INFO:Logging Dir: D:\Py\M2KT\results\mimic_cxr\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144
03-29 21:15:52-INFO:Visual Extractor:resnet101   d_vf: 2048
03-29 21:15:52-INFO:==>> Set GPU devices: 0
03-29 21:15:52-INFO:Namespace(image_dir='data/mimic/r2gen/images/images224/files', ann_path='data/mimic/r2gen/images/images224/annotation.json', label_path='data/mimic/finding/chexpert_labeled.csv', image_size=256, crop_size=224, dataset_name='mimic_cxr', max_seq_length=80, threshold=3, num_workers=4, batch_size=16, version='12', visual_extractor='resnet101', visual_extractor_pretrained=True, pretrain_cnn_file=None, d_model=512, d_ff=512, d_vf=2048, num_heads=8, num_memory_heads=8, num_layers=3, num_labels=14, dropout=0.1, logit_layers=1, bos_idx=0, eos_idx=0, pad_idx=0, use_bn=0, drop_prob_lm=0.1, sample_method='beam_search', beam_size=3, temperature=1.0, sample_n=1, group_size=1, output_logsoftmax=1, decoding_constraint=0, block_trigrams=1, n_gpu=1, epochs=30, save_dir='D:\\Py\\M2KT\\results\\mimic_cxr\\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144', expe_name='', record_dir='records/', save_period=1, monitor_mode='max', monitor_metric='BLEU_4', early_stop=50, label_smoothing=0.1, alpha=0.5, grad_clip=5, test_steps=500, label_loss=True, rank_loss=True, optim='Adam', lr_ve=5e-05, lr_ed=0.0001, weight_decay=5e-05, amsgrad=True, lr_scheduler='StepLR', step_size=1, gamma=0.8, seed=456789, gpu='0', resume='D:\\Py\\M2KT\\results\\mimic_cxr\\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144\\current_checkpoint.pth', num_slots=60, rm_num_heads=8, rm_d_model=512, cfg='config/mimic_resnet.yml', set_cfgs=[])
03-29 21:16:12-INFO:Model name: LAMRGModel_v12 	Model Layers:3
03-29 21:16:16-INFO:Loading checkpoint: D:\Py\M2KT\results\mimic_cxr\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144\current_checkpoint.pth ...
03-29 21:16:56-INFO:Checkpoint loaded. Resume training from epoch 7
03-29 21:16:56-INFO:==>> Model lr: 2.62144e-05, Visual Encoder lr: 1.31072e-05
03-29 21:17:45-INFO:=> User Stop!
03-29 21:17:52-INFO:Saved checkpint!
03-29 21:17:52-INFO:
********************Best results********************
03-29 21:17:52-INFO:Best results (w.r.t BLEU_4) in validation set:
03-29 21:17:52-INFO:VAL ||| Epoch: 4|||train_loss: 1.576||| BLEU_1: 0.2962 |||BLEU_2: 0.1605 |||BLEU_3: 0.09634 |||BLEU_4: 0.06338 |||CIDEr: 0.0622 |||ROUGE_L: 0.2237
03-29 21:17:52-INFO:TEST || Epoch: 4|||train_loss: 1.576||| BLEU_1: 0.3073 |||BLEU_2: 0.1631 |||BLEU_3: 0.09477 |||BLEU_4: 0.06068 |||CIDEr: 0.06452 |||ROUGE_L: 0.2197
03-29 21:17:52-INFO:Best results (w.r.t BLEU_4) in test set:
03-29 21:17:52-INFO:VAL ||| Epoch: 4|||train_loss: 1.576||| BLEU_1: 0.2962 |||BLEU_2: 0.1605 |||BLEU_3: 0.09634 |||BLEU_4: 0.06338 |||CIDEr: 0.0622 |||ROUGE_L: 0.2237
03-29 21:17:52-INFO:TEST || Epoch: 4|||train_loss: 1.576||| BLEU_1: 0.3073 |||BLEU_2: 0.1631 |||BLEU_3: 0.09477 |||BLEU_4: 0.06068 |||CIDEr: 0.06452 |||ROUGE_L: 0.2197
03-29 21:17:54-INFO:Namespace(image_dir='data/mimic/r2gen/images/images224/files', ann_path='data/mimic/r2gen/images/images224/annotation.json', label_path='data/mimic/finding/chexpert_labeled.csv', image_size=256, crop_size=224, dataset_name='mimic_cxr', max_seq_length=80, threshold=3, num_workers=4, batch_size=16, version='12', visual_extractor='resnet101', visual_extractor_pretrained=True, pretrain_cnn_file=None, d_model=512, d_ff=512, d_vf=2048, num_heads=8, num_memory_heads=8, num_layers=3, num_labels=14, dropout=0.1, logit_layers=1, bos_idx=0, eos_idx=0, pad_idx=0, use_bn=0, drop_prob_lm=0.1, sample_method='beam_search', beam_size=3, temperature=1.0, sample_n=1, group_size=1, output_logsoftmax=1, decoding_constraint=0, block_trigrams=1, n_gpu=1, epochs=30, save_dir='results\\mimic_cxr\\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144', expe_name='10th_try_balanced_train', record_dir='records/', save_period=1, monitor_mode='max', monitor_metric='BLEU_4', early_stop=50, label_smoothing=0.1, alpha=0.5, grad_clip=5, test_steps=500, label_loss=True, rank_loss=True, optim='Adam', lr_ve=5e-05, lr_ed=0.0001, weight_decay=5e-05, amsgrad=True, lr_scheduler='StepLR', step_size=1, gamma=0.8, seed=456789, gpu='0', resume=None, num_slots=60, rm_num_heads=8, rm_d_model=512, cfg='config/mimic_resnet.yml', set_cfgs=[])
03-30 00:26:57-INFO:Logging Dir: D:\Py\M2KT\results\mimic_cxr\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144
03-30 00:26:57-INFO:Visual Extractor:resnet101   d_vf: 2048
03-30 00:26:57-INFO:==>> Set GPU devices: 0
03-30 00:26:57-INFO:Namespace(image_dir='data/mimic/r2gen/images/images224/files', ann_path='data/mimic/r2gen/images/images224/annotation.json', label_path='data/mimic/finding/chexpert_labeled.csv', image_size=256, crop_size=224, dataset_name='mimic_cxr', max_seq_length=80, threshold=3, num_workers=4, batch_size=16, version='12', visual_extractor='resnet101', visual_extractor_pretrained=True, pretrain_cnn_file=None, d_model=512, d_ff=512, d_vf=2048, num_heads=8, num_memory_heads=8, num_layers=3, num_labels=14, dropout=0.1, logit_layers=1, bos_idx=0, eos_idx=0, pad_idx=0, use_bn=0, drop_prob_lm=0.1, sample_method='beam_search', beam_size=3, temperature=1.0, sample_n=1, group_size=1, output_logsoftmax=1, decoding_constraint=0, block_trigrams=1, n_gpu=1, epochs=30, save_dir='D:\\Py\\M2KT\\results\\mimic_cxr\\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144', expe_name='', record_dir='records/', save_period=1, monitor_mode='max', monitor_metric='BLEU_4', early_stop=50, label_smoothing=0.1, alpha=0.5, grad_clip=5, test_steps=500, label_loss=True, rank_loss=True, optim='Adam', lr_ve=5e-05, lr_ed=0.0001, weight_decay=5e-05, amsgrad=True, lr_scheduler='StepLR', step_size=1, gamma=0.8, seed=456789, gpu='0', resume='D:\\Py\\M2KT\\results\\mimic_cxr\\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144\\interrupted_checkpoint.pth', num_slots=60, rm_num_heads=8, rm_d_model=512, cfg='config/mimic_resnet.yml', set_cfgs=[])
03-30 00:27:30-INFO:Logging Dir: D:\Py\M2KT\results\mimic_cxr\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144
03-30 00:27:30-INFO:Visual Extractor:resnet101   d_vf: 2048
03-30 00:27:30-INFO:==>> Set GPU devices: 0
03-30 00:27:30-INFO:Namespace(image_dir='data/mimic/r2gen/images/images224/files', ann_path='data/mimic/r2gen/images/images224/annotation.json', label_path='data/mimic/finding/chexpert_labeled.csv', image_size=256, crop_size=224, dataset_name='mimic_cxr', max_seq_length=80, threshold=3, num_workers=4, batch_size=16, version='12', visual_extractor='resnet101', visual_extractor_pretrained=True, pretrain_cnn_file=None, d_model=512, d_ff=512, d_vf=2048, num_heads=8, num_memory_heads=8, num_layers=3, num_labels=14, dropout=0.1, logit_layers=1, bos_idx=0, eos_idx=0, pad_idx=0, use_bn=0, drop_prob_lm=0.1, sample_method='beam_search', beam_size=3, temperature=1.0, sample_n=1, group_size=1, output_logsoftmax=1, decoding_constraint=0, block_trigrams=1, n_gpu=1, epochs=30, save_dir='D:\\Py\\M2KT\\results\\mimic_cxr\\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144', expe_name='', record_dir='records/', save_period=1, monitor_mode='max', monitor_metric='BLEU_4', early_stop=50, label_smoothing=0.1, alpha=0.5, grad_clip=5, test_steps=500, label_loss=True, rank_loss=True, optim='Adam', lr_ve=5e-05, lr_ed=0.0001, weight_decay=5e-05, amsgrad=True, lr_scheduler='StepLR', step_size=1, gamma=0.8, seed=456789, gpu='0', resume='D:\\Py\\M2KT\\results\\mimic_cxr\\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144\\interrupt_checkpoint.pth', num_slots=60, rm_num_heads=8, rm_d_model=512, cfg='config/mimic_resnet.yml', set_cfgs=[])
03-30 00:27:46-INFO:Model name: LAMRGModel_v12 	Model Layers:3
03-30 00:27:47-INFO:Loading checkpoint: D:\Py\M2KT\results\mimic_cxr\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144\interrupt_checkpoint.pth ...
03-30 00:27:49-INFO:Checkpoint loaded. Resume training from epoch 8
03-30 00:27:49-INFO:==>> Model lr: 2.62144e-05, Visual Encoder lr: 1.31072e-05
03-30 02:25:50-INFO:Epoch [8/30] - D:\Py\M2KT\results\mimic_cxr\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144
03-30 02:25:50-INFO:VAL ||| Epoch: 8|||train_loss: 1.427||| BLEU_1: 0.3027 |||BLEU_2: 0.1657 |||BLEU_3: 0.09985 |||BLEU_4: 0.06617 |||CIDEr: 0.06332 |||ROUGE_L: 0.2304
03-30 02:25:50-INFO:TEST || Epoch: 8|||train_loss: 1.427||| BLEU_1: 0.3119 |||BLEU_2: 0.1664 |||BLEU_3: 0.09738 |||BLEU_4: 0.06302 |||CIDEr: 0.06529 |||ROUGE_L: 0.2195
03-30 02:26:09-INFO:Saving current best: model_best.pth ...
03-30 02:26:09-INFO:==>> Model lr: 2.097152e-05, Visual Encoder lr: 1.048576e-05
03-30 04:22:46-INFO:Epoch [9/30] - D:\Py\M2KT\results\mimic_cxr\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144
03-30 04:22:46-INFO:VAL ||| Epoch: 9|||train_loss: 1.398||| BLEU_1: 0.2998 |||BLEU_2: 0.1601 |||BLEU_3: 0.09527 |||BLEU_4: 0.06265 |||CIDEr: 0.06613 |||ROUGE_L: 0.2274
03-30 04:22:46-INFO:TEST || Epoch: 9|||train_loss: 1.398||| BLEU_1: 0.312 |||BLEU_2: 0.1636 |||BLEU_3: 0.0953 |||BLEU_4: 0.06188 |||CIDEr: 0.06323 |||ROUGE_L: 0.2204
03-30 04:22:53-INFO:==>> Model lr: 1.677722e-05, Visual Encoder lr: 8.388608e-06
03-30 06:17:48-INFO:Epoch [10/30] - D:\Py\M2KT\results\mimic_cxr\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144
03-30 06:17:48-INFO:VAL ||| Epoch: 10|||train_loss: 1.378||| BLEU_1: 0.306 |||BLEU_2: 0.1656 |||BLEU_3: 0.09742 |||BLEU_4: 0.06283 |||CIDEr: 0.06677 |||ROUGE_L: 0.2298
03-30 06:17:48-INFO:TEST || Epoch: 10|||train_loss: 1.378||| BLEU_1: 0.317 |||BLEU_2: 0.1689 |||BLEU_3: 0.09813 |||BLEU_4: 0.06299 |||CIDEr: 0.07316 |||ROUGE_L: 0.2226
03-30 06:17:53-INFO:==>> Model lr: 1.342177e-05, Visual Encoder lr: 6.710886e-06
03-30 08:13:38-INFO:Epoch [11/30] - D:\Py\M2KT\results\mimic_cxr\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144
03-30 08:13:38-INFO:VAL ||| Epoch: 11|||train_loss: 1.365||| BLEU_1: 0.305 |||BLEU_2: 0.164 |||BLEU_3: 0.09717 |||BLEU_4: 0.063 |||CIDEr: 0.065 |||ROUGE_L: 0.2299
03-30 08:13:38-INFO:TEST || Epoch: 11|||train_loss: 1.365||| BLEU_1: 0.3171 |||BLEU_2: 0.1696 |||BLEU_3: 0.0993 |||BLEU_4: 0.06424 |||CIDEr: 0.07003 |||ROUGE_L: 0.2237
03-30 08:13:44-INFO:==>> Model lr: 1.073742e-05, Visual Encoder lr: 5.368709e-06
03-30 10:38:47-INFO:Epoch [12/30] - D:\Py\M2KT\results\mimic_cxr\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144
03-30 10:38:47-INFO:VAL ||| Epoch: 12|||train_loss: 1.354||| BLEU_1: 0.3066 |||BLEU_2: 0.1628 |||BLEU_3: 0.09548 |||BLEU_4: 0.06183 |||CIDEr: 0.06733 |||ROUGE_L: 0.2304
03-30 10:38:47-INFO:TEST || Epoch: 12|||train_loss: 1.354||| BLEU_1: 0.3181 |||BLEU_2: 0.1697 |||BLEU_3: 0.09971 |||BLEU_4: 0.06469 |||CIDEr: 0.07157 |||ROUGE_L: 0.2254
03-30 10:38:53-INFO:==>> Model lr: 8.589935e-06, Visual Encoder lr: 4.294967e-06
03-30 13:01:48-INFO:Epoch [13/30] - D:\Py\M2KT\results\mimic_cxr\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144
03-30 13:01:48-INFO:VAL ||| Epoch: 13|||train_loss: 1.347||| BLEU_1: 0.3034 |||BLEU_2: 0.1632 |||BLEU_3: 0.09696 |||BLEU_4: 0.06323 |||CIDEr: 0.06155 |||ROUGE_L: 0.2287
03-30 13:01:48-INFO:TEST || Epoch: 13|||train_loss: 1.347||| BLEU_1: 0.3146 |||BLEU_2: 0.1689 |||BLEU_3: 0.09943 |||BLEU_4: 0.06481 |||CIDEr: 0.06559 |||ROUGE_L: 0.2229
03-30 13:01:54-INFO:==>> Model lr: 6.871948e-06, Visual Encoder lr: 3.435974e-06
03-30 15:26:11-INFO:Epoch [14/30] - D:\Py\M2KT\results\mimic_cxr\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144
03-30 15:26:11-INFO:VAL ||| Epoch: 14|||train_loss: 1.352||| BLEU_1: 0.3076 |||BLEU_2: 0.1668 |||BLEU_3: 0.09959 |||BLEU_4: 0.06493 |||CIDEr: 0.06691 |||ROUGE_L: 0.2327
03-30 15:26:11-INFO:TEST || Epoch: 14|||train_loss: 1.352||| BLEU_1: 0.3189 |||BLEU_2: 0.1723 |||BLEU_3: 0.1022 |||BLEU_4: 0.06658 |||CIDEr: 0.07158 |||ROUGE_L: 0.2267
03-30 15:26:17-INFO:==>> Model lr: 5.497558e-06, Visual Encoder lr: 2.748779e-06
03-30 18:06:04-INFO:Epoch [15/30] - D:\Py\M2KT\results\mimic_cxr\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144
03-30 18:06:04-INFO:VAL ||| Epoch: 15|||train_loss: 1.351||| BLEU_1: 0.3074 |||BLEU_2: 0.1649 |||BLEU_3: 0.09711 |||BLEU_4: 0.06328 |||CIDEr: 0.06817 |||ROUGE_L: 0.2296
03-30 18:06:04-INFO:TEST || Epoch: 15|||train_loss: 1.351||| BLEU_1: 0.317 |||BLEU_2: 0.1686 |||BLEU_3: 0.09833 |||BLEU_4: 0.06342 |||CIDEr: 0.06936 |||ROUGE_L: 0.2236
03-30 18:06:11-INFO:==>> Model lr: 4.398047e-06, Visual Encoder lr: 2.199023e-06
03-30 20:38:37-INFO:Epoch [16/30] - D:\Py\M2KT\results\mimic_cxr\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144
03-30 20:38:37-INFO:VAL ||| Epoch: 16|||train_loss: 1.346||| BLEU_1: 0.3068 |||BLEU_2: 0.1663 |||BLEU_3: 0.09926 |||BLEU_4: 0.06436 |||CIDEr: 0.06165 |||ROUGE_L: 0.2316
03-30 20:38:37-INFO:TEST || Epoch: 16|||train_loss: 1.346||| BLEU_1: 0.3184 |||BLEU_2: 0.1716 |||BLEU_3: 0.1014 |||BLEU_4: 0.06558 |||CIDEr: 0.07258 |||ROUGE_L: 0.2262
03-30 20:38:44-INFO:==>> Model lr: 3.518437e-06, Visual Encoder lr: 1.759219e-06
03-30 21:18:16-INFO:=> User Stop!
03-30 21:18:25-INFO:Saved checkpint!
03-30 21:18:25-INFO:
********************Best results********************
03-30 21:18:25-INFO:Best results (w.r.t BLEU_4) in validation set:
03-30 21:18:25-INFO:VAL ||| Epoch: 8|||train_loss: 1.427||| BLEU_1: 0.3027 |||BLEU_2: 0.1657 |||BLEU_3: 0.09985 |||BLEU_4: 0.06617 |||CIDEr: 0.06332 |||ROUGE_L: 0.2304
03-30 21:18:25-INFO:TEST || Epoch: 8|||train_loss: 1.427||| BLEU_1: 0.3119 |||BLEU_2: 0.1664 |||BLEU_3: 0.09738 |||BLEU_4: 0.06302 |||CIDEr: 0.06529 |||ROUGE_L: 0.2195
03-30 21:18:25-INFO:Best results (w.r.t BLEU_4) in test set:
03-30 21:18:25-INFO:VAL ||| Epoch: 14|||train_loss: 1.352||| BLEU_1: 0.3076 |||BLEU_2: 0.1668 |||BLEU_3: 0.09959 |||BLEU_4: 0.06493 |||CIDEr: 0.06691 |||ROUGE_L: 0.2327
03-30 21:18:25-INFO:TEST || Epoch: 14|||train_loss: 1.352||| BLEU_1: 0.3189 |||BLEU_2: 0.1723 |||BLEU_3: 0.1022 |||BLEU_4: 0.06658 |||CIDEr: 0.07158 |||ROUGE_L: 0.2267
03-30 21:18:27-INFO:Namespace(image_dir='data/mimic/r2gen/images/images224/files', ann_path='data/mimic/r2gen/images/images224/annotation.json', label_path='data/mimic/finding/chexpert_labeled.csv', image_size=256, crop_size=224, dataset_name='mimic_cxr', max_seq_length=80, threshold=3, num_workers=4, batch_size=16, version='12', visual_extractor='resnet101', visual_extractor_pretrained=True, pretrain_cnn_file=None, d_model=512, d_ff=512, d_vf=2048, num_heads=8, num_memory_heads=8, num_layers=3, num_labels=14, dropout=0.1, logit_layers=1, bos_idx=0, eos_idx=0, pad_idx=0, use_bn=0, drop_prob_lm=0.1, sample_method='beam_search', beam_size=3, temperature=1.0, sample_n=1, group_size=1, output_logsoftmax=1, decoding_constraint=0, block_trigrams=1, n_gpu=1, epochs=30, save_dir='D:\\Py\\M2KT\\results\\mimic_cxr\\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144', expe_name='', record_dir='records/', save_period=1, monitor_mode='max', monitor_metric='BLEU_4', early_stop=50, label_smoothing=0.1, alpha=0.5, grad_clip=5, test_steps=500, label_loss=True, rank_loss=True, optim='Adam', lr_ve=5e-05, lr_ed=0.0001, weight_decay=5e-05, amsgrad=True, lr_scheduler='StepLR', step_size=1, gamma=0.8, seed=456789, gpu='0', resume='D:\\Py\\M2KT\\results\\mimic_cxr\\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144\\interrupt_checkpoint.pth', num_slots=60, rm_num_heads=8, rm_d_model=512, cfg='config/mimic_resnet.yml', set_cfgs=[])
03-31 00:38:54-INFO:Logging Dir: D:\Py\M2KT\results\mimic_cxr\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144
03-31 00:38:54-INFO:Visual Extractor:resnet101   d_vf: 2048
03-31 00:38:54-INFO:==>> Set GPU devices: 0
03-31 00:38:54-INFO:Namespace(image_dir='data/mimic/r2gen/images/images224/files', ann_path='data/mimic/r2gen/images/images224/annotation.json', label_path='data/mimic/finding/chexpert_labeled.csv', image_size=256, crop_size=224, dataset_name='mimic_cxr', max_seq_length=80, threshold=3, num_workers=4, batch_size=16, version='12', visual_extractor='resnet101', visual_extractor_pretrained=True, pretrain_cnn_file=None, d_model=512, d_ff=512, d_vf=2048, num_heads=8, num_memory_heads=8, num_layers=3, num_labels=14, dropout=0.1, logit_layers=1, bos_idx=0, eos_idx=0, pad_idx=0, use_bn=0, drop_prob_lm=0.1, sample_method='beam_search', beam_size=3, temperature=1.0, sample_n=1, group_size=1, output_logsoftmax=1, decoding_constraint=0, block_trigrams=1, n_gpu=1, epochs=30, save_dir='D:\\Py\\M2KT\\results\\mimic_cxr\\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144', expe_name='', record_dir='records/', save_period=1, monitor_mode='max', monitor_metric='BLEU_4', early_stop=50, label_smoothing=0.1, alpha=0.5, grad_clip=5, test_steps=500, label_loss=True, rank_loss=True, optim='Adam', lr_ve=5e-05, lr_ed=0.0001, weight_decay=5e-05, amsgrad=True, lr_scheduler='StepLR', step_size=1, gamma=0.8, seed=456789, gpu='0', resume='D:\\Py\\M2KT\\results\\mimic_cxr\\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144\\interrupt_checkpoint.pth', num_slots=60, rm_num_heads=8, rm_d_model=512, cfg='config/mimic_resnet.yml', set_cfgs=[])
03-31 00:39:10-INFO:Model name: LAMRGModel_v12 	Model Layers:3
03-31 00:39:12-INFO:Loading checkpoint: D:\Py\M2KT\results\mimic_cxr\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144\interrupt_checkpoint.pth ...
03-31 00:39:24-INFO:Checkpoint loaded. Resume training from epoch 18
03-31 00:39:24-INFO:==>> Model lr: 3.518437e-06, Visual Encoder lr: 1.759219e-06
03-31 02:34:02-INFO:Epoch [18/30] - D:\Py\M2KT\results\mimic_cxr\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144
03-31 02:34:02-INFO:VAL ||| Epoch: 18|||train_loss: 1.318||| BLEU_1: 0.3094 |||BLEU_2: 0.167 |||BLEU_3: 0.09845 |||BLEU_4: 0.06372 |||CIDEr: 0.06381 |||ROUGE_L: 0.2302
03-31 02:34:02-INFO:TEST || Epoch: 18|||train_loss: 1.318||| BLEU_1: 0.3212 |||BLEU_2: 0.1716 |||BLEU_3: 0.1002 |||BLEU_4: 0.06465 |||CIDEr: 0.06831 |||ROUGE_L: 0.2241
03-31 02:34:09-INFO:==>> Model lr: 2.81475e-06, Visual Encoder lr: 1.407375e-06
03-31 04:48:30-INFO:Epoch [19/30] - D:\Py\M2KT\results\mimic_cxr\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144
03-31 04:48:30-INFO:VAL ||| Epoch: 19|||train_loss: 1.311||| BLEU_1: 0.3082 |||BLEU_2: 0.1671 |||BLEU_3: 0.09976 |||BLEU_4: 0.06564 |||CIDEr: 0.06725 |||ROUGE_L: 0.2314
03-31 04:48:30-INFO:TEST || Epoch: 19|||train_loss: 1.311||| BLEU_1: 0.3193 |||BLEU_2: 0.1725 |||BLEU_3: 0.1024 |||BLEU_4: 0.06696 |||CIDEr: 0.06985 |||ROUGE_L: 0.2252
03-31 04:48:37-INFO:==>> Model lr: 2.2518e-06, Visual Encoder lr: 1.1259e-06
03-31 07:08:43-INFO:Epoch [20/30] - D:\Py\M2KT\results\mimic_cxr\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144
03-31 07:08:43-INFO:VAL ||| Epoch: 20|||train_loss: 1.309||| BLEU_1: 0.3077 |||BLEU_2: 0.1666 |||BLEU_3: 0.09908 |||BLEU_4: 0.06464 |||CIDEr: 0.06668 |||ROUGE_L: 0.2317
03-31 07:08:43-INFO:TEST || Epoch: 20|||train_loss: 1.309||| BLEU_1: 0.3212 |||BLEU_2: 0.1737 |||BLEU_3: 0.1028 |||BLEU_4: 0.06688 |||CIDEr: 0.07618 |||ROUGE_L: 0.2262
03-31 07:08:49-INFO:==>> Model lr: 1.80144e-06, Visual Encoder lr: 9.007199e-07
03-31 09:28:36-INFO:Epoch [21/30] - D:\Py\M2KT\results\mimic_cxr\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144
03-31 09:28:36-INFO:VAL ||| Epoch: 21|||train_loss: 1.308||| BLEU_1: 0.3093 |||BLEU_2: 0.1691 |||BLEU_3: 0.1015 |||BLEU_4: 0.06656 |||CIDEr: 0.06648 |||ROUGE_L: 0.2329
03-31 09:28:36-INFO:TEST || Epoch: 21|||train_loss: 1.308||| BLEU_1: 0.3224 |||BLEU_2: 0.1756 |||BLEU_3: 0.1046 |||BLEU_4: 0.06876 |||CIDEr: 0.07647 |||ROUGE_L: 0.2285
03-31 09:28:54-INFO:Saving current best: model_best.pth ...
03-31 09:28:54-INFO:==>> Model lr: 1.441152e-06, Visual Encoder lr: 7.205759e-07
03-31 12:22:16-INFO:Epoch [22/30] - D:\Py\M2KT\results\mimic_cxr\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144
03-31 12:22:16-INFO:VAL ||| Epoch: 22|||train_loss: 1.309||| BLEU_1: 0.309 |||BLEU_2: 0.1669 |||BLEU_3: 0.09915 |||BLEU_4: 0.06507 |||CIDEr: 0.06667 |||ROUGE_L: 0.2314
03-31 12:22:16-INFO:TEST || Epoch: 22|||train_loss: 1.309||| BLEU_1: 0.323 |||BLEU_2: 0.1744 |||BLEU_3: 0.1028 |||BLEU_4: 0.06701 |||CIDEr: 0.07552 |||ROUGE_L: 0.2267
03-31 12:22:23-INFO:==>> Model lr: 1.152922e-06, Visual Encoder lr: 5.764608e-07
03-31 14:45:08-INFO:Epoch [23/30] - D:\Py\M2KT\results\mimic_cxr\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144
03-31 14:45:08-INFO:VAL ||| Epoch: 23|||train_loss: 1.31||| BLEU_1: 0.3082 |||BLEU_2: 0.1652 |||BLEU_3: 0.09733 |||BLEU_4: 0.06332 |||CIDEr: 0.06943 |||ROUGE_L: 0.2295
03-31 14:45:08-INFO:TEST || Epoch: 23|||train_loss: 1.31||| BLEU_1: 0.3221 |||BLEU_2: 0.1734 |||BLEU_3: 0.1023 |||BLEU_4: 0.0669 |||CIDEr: 0.07139 |||ROUGE_L: 0.2258
03-31 14:45:14-INFO:==>> Model lr: 9.223372e-07, Visual Encoder lr: 4.611686e-07
03-31 17:11:41-INFO:Epoch [24/30] - D:\Py\M2KT\results\mimic_cxr\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144
03-31 17:11:41-INFO:VAL ||| Epoch: 24|||train_loss: 1.321||| BLEU_1: 0.3089 |||BLEU_2: 0.1676 |||BLEU_3: 0.1 |||BLEU_4: 0.06578 |||CIDEr: 0.07273 |||ROUGE_L: 0.2322
03-31 17:11:41-INFO:TEST || Epoch: 24|||train_loss: 1.321||| BLEU_1: 0.323 |||BLEU_2: 0.1754 |||BLEU_3: 0.1043 |||BLEU_4: 0.06827 |||CIDEr: 0.07474 |||ROUGE_L: 0.2278
03-31 17:11:47-INFO:==>> Model lr: 7.378698e-07, Visual Encoder lr: 3.689349e-07
03-31 19:31:39-INFO:Epoch [25/30] - D:\Py\M2KT\results\mimic_cxr\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144
03-31 19:31:39-INFO:VAL ||| Epoch: 25|||train_loss: 1.325||| BLEU_1: 0.3084 |||BLEU_2: 0.1672 |||BLEU_3: 0.09907 |||BLEU_4: 0.06478 |||CIDEr: 0.06906 |||ROUGE_L: 0.2316
03-31 19:31:39-INFO:TEST || Epoch: 25|||train_loss: 1.325||| BLEU_1: 0.3226 |||BLEU_2: 0.1744 |||BLEU_3: 0.1031 |||BLEU_4: 0.06734 |||CIDEr: 0.07666 |||ROUGE_L: 0.2265
03-31 19:31:45-INFO:==>> Model lr: 5.902958e-07, Visual Encoder lr: 2.951479e-07
03-31 21:56:49-INFO:Epoch [26/30] - D:\Py\M2KT\results\mimic_cxr\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144
03-31 21:56:49-INFO:VAL ||| Epoch: 26|||train_loss: 1.325||| BLEU_1: 0.3118 |||BLEU_2: 0.1707 |||BLEU_3: 0.1027 |||BLEU_4: 0.06732 |||CIDEr: 0.06845 |||ROUGE_L: 0.2345
03-31 21:56:49-INFO:TEST || Epoch: 26|||train_loss: 1.325||| BLEU_1: 0.3229 |||BLEU_2: 0.175 |||BLEU_3: 0.1034 |||BLEU_4: 0.06727 |||CIDEr: 0.07491 |||ROUGE_L: 0.2279
03-31 21:57:09-INFO:Saving current best: model_best.pth ...
03-31 21:57:09-INFO:==>> Model lr: 4.722366e-07, Visual Encoder lr: 2.361183e-07
03-31 21:59:51-INFO:=> User Stop!
03-31 21:59:58-INFO:Saved checkpint!
03-31 21:59:58-INFO:
********************Best results********************
03-31 21:59:58-INFO:Best results (w.r.t BLEU_4) in validation set:
03-31 21:59:58-INFO:VAL ||| Epoch: 26|||train_loss: 1.325||| BLEU_1: 0.3118 |||BLEU_2: 0.1707 |||BLEU_3: 0.1027 |||BLEU_4: 0.06732 |||CIDEr: 0.06845 |||ROUGE_L: 0.2345
03-31 21:59:58-INFO:TEST || Epoch: 26|||train_loss: 1.325||| BLEU_1: 0.3229 |||BLEU_2: 0.175 |||BLEU_3: 0.1034 |||BLEU_4: 0.06727 |||CIDEr: 0.07491 |||ROUGE_L: 0.2279
03-31 21:59:58-INFO:Best results (w.r.t BLEU_4) in test set:
03-31 21:59:58-INFO:VAL ||| Epoch: 21|||train_loss: 1.308||| BLEU_1: 0.3093 |||BLEU_2: 0.1691 |||BLEU_3: 0.1015 |||BLEU_4: 0.06656 |||CIDEr: 0.06648 |||ROUGE_L: 0.2329
03-31 21:59:58-INFO:TEST || Epoch: 21|||train_loss: 1.308||| BLEU_1: 0.3224 |||BLEU_2: 0.1756 |||BLEU_3: 0.1046 |||BLEU_4: 0.06876 |||CIDEr: 0.07647 |||ROUGE_L: 0.2285
03-31 22:00:00-INFO:Namespace(image_dir='data/mimic/r2gen/images/images224/files', ann_path='data/mimic/r2gen/images/images224/annotation.json', label_path='data/mimic/finding/chexpert_labeled.csv', image_size=256, crop_size=224, dataset_name='mimic_cxr', max_seq_length=80, threshold=3, num_workers=4, batch_size=16, version='12', visual_extractor='resnet101', visual_extractor_pretrained=True, pretrain_cnn_file=None, d_model=512, d_ff=512, d_vf=2048, num_heads=8, num_memory_heads=8, num_layers=3, num_labels=14, dropout=0.1, logit_layers=1, bos_idx=0, eos_idx=0, pad_idx=0, use_bn=0, drop_prob_lm=0.1, sample_method='beam_search', beam_size=3, temperature=1.0, sample_n=1, group_size=1, output_logsoftmax=1, decoding_constraint=0, block_trigrams=1, n_gpu=1, epochs=30, save_dir='D:\\Py\\M2KT\\results\\mimic_cxr\\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144', expe_name='', record_dir='records/', save_period=1, monitor_mode='max', monitor_metric='BLEU_4', early_stop=50, label_smoothing=0.1, alpha=0.5, grad_clip=5, test_steps=500, label_loss=True, rank_loss=True, optim='Adam', lr_ve=5e-05, lr_ed=0.0001, weight_decay=5e-05, amsgrad=True, lr_scheduler='StepLR', step_size=1, gamma=0.8, seed=456789, gpu='0', resume='D:\\Py\\M2KT\\results\\mimic_cxr\\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144\\interrupt_checkpoint.pth', num_slots=60, rm_num_heads=8, rm_d_model=512, cfg='config/mimic_resnet.yml', set_cfgs=[])
04-02 02:40:12-INFO:Logging Dir: D:\Py\M2KT\results\mimic_cxr\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144
04-02 02:40:12-INFO:Visual Extractor:resnet101   d_vf: 2048
04-02 02:40:12-INFO:==>> Set GPU devices: 0
04-02 02:40:12-INFO:Namespace(image_dir='data/mimic/r2gen/images/images224/files', ann_path='data/mimic/r2gen/images/images224/annotation.json', label_path='data/mimic/finding/chexpert_labeled.csv', image_size=256, crop_size=224, dataset_name='mimic_cxr', max_seq_length=80, threshold=3, num_workers=4, batch_size=16, version='12', visual_extractor='resnet101', visual_extractor_pretrained=True, pretrain_cnn_file=None, d_model=512, d_ff=512, d_vf=2048, num_heads=8, num_memory_heads=8, num_layers=3, num_labels=14, dropout=0.1, logit_layers=1, bos_idx=0, eos_idx=0, pad_idx=0, use_bn=0, drop_prob_lm=0.1, sample_method='beam_search', beam_size=3, temperature=1.0, sample_n=1, group_size=1, output_logsoftmax=1, decoding_constraint=0, block_trigrams=1, n_gpu=1, epochs=30, save_dir='D:\\Py\\M2KT\\results\\mimic_cxr\\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144', expe_name='', record_dir='records/', save_period=1, monitor_mode='max', monitor_metric='BLEU_4', early_stop=50, label_smoothing=0.1, alpha=0.5, grad_clip=5, test_steps=500, label_loss=True, rank_loss=True, optim='Adam', lr_ve=5e-05, lr_ed=0.0001, weight_decay=5e-05, amsgrad=True, lr_scheduler='StepLR', step_size=1, gamma=0.8, seed=456789, gpu='0', resume='D:\\Py\\M2KT\\results\\mimic_cxr\\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144\\interrupt_checkpoint.pth', num_slots=60, rm_num_heads=8, rm_d_model=512, cfg='config/mimic_resnet.yml', set_cfgs=[])
04-02 02:40:29-INFO:Model name: LAMRGModel_v12 	Model Layers:3
04-02 02:40:35-INFO:Loading checkpoint: D:\Py\M2KT\results\mimic_cxr\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144\interrupt_checkpoint.pth ...
04-02 02:40:49-INFO:Checkpoint loaded. Resume training from epoch 28
04-02 02:40:49-INFO:==>> Model lr: 4.722366e-07, Visual Encoder lr: 2.361183e-07
04-02 04:26:13-INFO:Epoch [28/30] - D:\Py\M2KT\results\mimic_cxr\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144
04-02 04:26:13-INFO:VAL ||| Epoch: 28|||train_loss: 1.302||| BLEU_1: 0.3099 |||BLEU_2: 0.1689 |||BLEU_3: 0.101 |||BLEU_4: 0.06636 |||CIDEr: 0.07217 |||ROUGE_L: 0.2327
04-02 04:26:13-INFO:TEST || Epoch: 28|||train_loss: 1.302||| BLEU_1: 0.3238 |||BLEU_2: 0.175 |||BLEU_3: 0.1033 |||BLEU_4: 0.06732 |||CIDEr: 0.07413 |||ROUGE_L: 0.2275
04-02 04:26:21-INFO:==>> Model lr: 3.777893e-07, Visual Encoder lr: 1.888947e-07
04-02 06:12:05-INFO:Epoch [29/30] - D:\Py\M2KT\results\mimic_cxr\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144
04-02 06:12:05-INFO:VAL ||| Epoch: 29|||train_loss: 1.299||| BLEU_1: 0.3097 |||BLEU_2: 0.1686 |||BLEU_3: 0.1005 |||BLEU_4: 0.06585 |||CIDEr: 0.0672 |||ROUGE_L: 0.2322
04-02 06:12:05-INFO:TEST || Epoch: 29|||train_loss: 1.299||| BLEU_1: 0.3233 |||BLEU_2: 0.1754 |||BLEU_3: 0.1037 |||BLEU_4: 0.0677 |||CIDEr: 0.07642 |||ROUGE_L: 0.2275
04-02 06:12:11-INFO:==>> Model lr: 3.022315e-07, Visual Encoder lr: 1.511157e-07
04-02 07:58:37-INFO:Epoch [30/30] - D:\Py\M2KT\results\mimic_cxr\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144
04-02 07:58:37-INFO:VAL ||| Epoch: 30|||train_loss: 1.299||| BLEU_1: 0.3089 |||BLEU_2: 0.1683 |||BLEU_3: 0.1005 |||BLEU_4: 0.066 |||CIDEr: 0.06937 |||ROUGE_L: 0.2328
04-02 07:58:37-INFO:TEST || Epoch: 30|||train_loss: 1.299||| BLEU_1: 0.3233 |||BLEU_2: 0.1751 |||BLEU_3: 0.1036 |||BLEU_4: 0.06745 |||CIDEr: 0.07545 |||ROUGE_L: 0.2274
04-02 07:58:44-INFO:
********************Best results********************
04-02 07:58:44-INFO:Best results (w.r.t BLEU_4) in validation set:
04-02 07:58:44-INFO:===>> There are not Best Results during this time running!
04-02 07:58:44-INFO:Best results (w.r.t BLEU_4) in test set:
04-02 07:58:44-INFO:VAL ||| Epoch: 29|||train_loss: 1.299||| BLEU_1: 0.3097 |||BLEU_2: 0.1686 |||BLEU_3: 0.1005 |||BLEU_4: 0.06585 |||CIDEr: 0.0672 |||ROUGE_L: 0.2322
04-02 07:58:44-INFO:TEST || Epoch: 29|||train_loss: 1.299||| BLEU_1: 0.3233 |||BLEU_2: 0.1754 |||BLEU_3: 0.1037 |||BLEU_4: 0.0677 |||CIDEr: 0.07642 |||ROUGE_L: 0.2275
04-02 07:58:46-INFO:Namespace(image_dir='data/mimic/r2gen/images/images224/files', ann_path='data/mimic/r2gen/images/images224/annotation.json', label_path='data/mimic/finding/chexpert_labeled.csv', image_size=256, crop_size=224, dataset_name='mimic_cxr', max_seq_length=80, threshold=3, num_workers=4, batch_size=16, version='12', visual_extractor='resnet101', visual_extractor_pretrained=True, pretrain_cnn_file=None, d_model=512, d_ff=512, d_vf=2048, num_heads=8, num_memory_heads=8, num_layers=3, num_labels=14, dropout=0.1, logit_layers=1, bos_idx=0, eos_idx=0, pad_idx=0, use_bn=0, drop_prob_lm=0.1, sample_method='beam_search', beam_size=3, temperature=1.0, sample_n=1, group_size=1, output_logsoftmax=1, decoding_constraint=0, block_trigrams=1, n_gpu=1, epochs=30, save_dir='D:\\Py\\M2KT\\results\\mimic_cxr\\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144', expe_name='', record_dir='records/', save_period=1, monitor_mode='max', monitor_metric='BLEU_4', early_stop=50, label_smoothing=0.1, alpha=0.5, grad_clip=5, test_steps=500, label_loss=True, rank_loss=True, optim='Adam', lr_ve=5e-05, lr_ed=0.0001, weight_decay=5e-05, amsgrad=True, lr_scheduler='StepLR', step_size=1, gamma=0.8, seed=456789, gpu='0', resume='D:\\Py\\M2KT\\results\\mimic_cxr\\V12_resnet101_labelloss_rankloss_10th_try_balanced_train_20240329-235144\\interrupt_checkpoint.pth', num_slots=60, rm_num_heads=8, rm_d_model=512, cfg='config/mimic_resnet.yml', set_cfgs=[])
