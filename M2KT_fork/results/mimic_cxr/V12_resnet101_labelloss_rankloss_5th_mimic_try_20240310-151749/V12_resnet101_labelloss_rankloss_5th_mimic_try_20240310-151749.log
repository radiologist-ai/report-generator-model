03-10 00:17:49-INFO:Logging Dir: results\mimic_cxr\V12_resnet101_labelloss_rankloss_5th_mimic_try_20240310-151749
03-10 00:17:49-INFO:Visual Extractor:resnet101   d_vf: 2048
03-10 00:17:49-INFO:==>> Set GPU devices: 0
03-10 00:17:49-INFO:Namespace(image_dir='data/mimic/r2gen/images/images224/files', ann_path='data/mimic/r2gen/images/images224/annotation.json', label_path='data/mimic/finding/chexpert_labeled.csv', image_size=256, crop_size=224, dataset_name='mimic_cxr', max_seq_length=80, threshold=3, num_workers=4, batch_size=16, version='12', visual_extractor='resnet101', visual_extractor_pretrained=True, pretrain_cnn_file=None, d_model=512, d_ff=512, d_vf=2048, num_heads=8, num_memory_heads=8, num_layers=3, num_labels=14, dropout=0.1, logit_layers=1, bos_idx=0, eos_idx=0, pad_idx=0, use_bn=0, drop_prob_lm=0.1, sample_method='beam_search', beam_size=3, temperature=1.0, sample_n=1, group_size=1, output_logsoftmax=1, decoding_constraint=0, block_trigrams=1, n_gpu=1, epochs=30, save_dir='results\\mimic_cxr\\V12_resnet101_labelloss_rankloss_5th_mimic_try_20240310-151749', expe_name='5th_mimic_try', record_dir='records/', save_period=1, monitor_mode='max', monitor_metric='BLEU_4', early_stop=50, label_smoothing=0.1, alpha=0.5, grad_clip=5, test_steps=500, label_loss=True, rank_loss=True, optim='Adam', lr_ve=5e-05, lr_ed=0.0001, weight_decay=5e-05, amsgrad=True, lr_scheduler='StepLR', step_size=1, gamma=0.8, seed=456789, gpu='0', resume=None, num_slots=60, rm_num_heads=8, rm_d_model=512, cfg='config/mimic_resnet.yml', set_cfgs=[])
03-10 00:17:57-INFO:Model name: LAMRGModel_v12 	Model Layers:3
03-10 00:18:00-INFO:==>> Model lr: 0.0001, Visual Encoder lr: 5e-05
03-10 01:10:11-INFO:Epoch [1/30] - results\mimic_cxr\V12_resnet101_labelloss_rankloss_5th_mimic_try_20240310-151749
03-10 01:10:11-INFO:VAL ||| Epoch: 1|||train_loss: 2.738||| BLEU_1: 0.2432 |||BLEU_2: 0.1266 |||BLEU_3: 0.07023 |||BLEU_4: 0.04322 |||CIDEr: 0.04541 |||ROUGE_L: 0.2082
03-10 01:10:11-INFO:TEST || Epoch: 1|||train_loss: 2.738||| BLEU_1: 0.2554 |||BLEU_2: 0.133 |||BLEU_3: 0.07417 |||BLEU_4: 0.04616 |||CIDEr: 0.06451 |||ROUGE_L: 0.2103
03-10 01:10:28-INFO:Saving current best: model_best.pth ...
03-10 01:10:28-INFO:==>> Model lr: 8e-05, Visual Encoder lr: 4e-05
03-10 02:14:11-INFO:Epoch [2/30] - results\mimic_cxr\V12_resnet101_labelloss_rankloss_5th_mimic_try_20240310-151749
03-10 02:14:11-INFO:VAL ||| Epoch: 2|||train_loss: 2.064||| BLEU_1: 0.2418 |||BLEU_2: 0.1239 |||BLEU_3: 0.06743 |||BLEU_4: 0.04215 |||CIDEr: 0.0348 |||ROUGE_L: 0.207
03-10 02:14:11-INFO:TEST || Epoch: 2|||train_loss: 2.064||| BLEU_1: 0.2542 |||BLEU_2: 0.1304 |||BLEU_3: 0.0712 |||BLEU_4: 0.04501 |||CIDEr: 0.04233 |||ROUGE_L: 0.208
03-10 02:14:16-INFO:==>> Model lr: 6.4e-05, Visual Encoder lr: 3.2e-05
03-10 03:17:38-INFO:Epoch [3/30] - results\mimic_cxr\V12_resnet101_labelloss_rankloss_5th_mimic_try_20240310-151749
03-10 03:17:38-INFO:VAL ||| Epoch: 3|||train_loss: 1.937||| BLEU_1: 0.2603 |||BLEU_2: 0.1397 |||BLEU_3: 0.08306 |||BLEU_4: 0.05291 |||CIDEr: 0.04536 |||ROUGE_L: 0.217
03-10 03:17:38-INFO:TEST || Epoch: 3|||train_loss: 1.937||| BLEU_1: 0.2748 |||BLEU_2: 0.151 |||BLEU_3: 0.09091 |||BLEU_4: 0.05868 |||CIDEr: 0.05856 |||ROUGE_L: 0.2194
03-10 03:17:54-INFO:Saving current best: model_best.pth ...
03-10 03:17:54-INFO:==>> Model lr: 5.12e-05, Visual Encoder lr: 2.56e-05
03-10 04:21:18-INFO:Epoch [4/30] - results\mimic_cxr\V12_resnet101_labelloss_rankloss_5th_mimic_try_20240310-151749
03-10 04:21:18-INFO:VAL ||| Epoch: 4|||train_loss: 1.869||| BLEU_1: 0.2578 |||BLEU_2: 0.1312 |||BLEU_3: 0.07029 |||BLEU_4: 0.04288 |||CIDEr: 0.04471 |||ROUGE_L: 0.2125
03-10 04:21:18-INFO:TEST || Epoch: 4|||train_loss: 1.869||| BLEU_1: 0.27 |||BLEU_2: 0.1376 |||BLEU_3: 0.07456 |||BLEU_4: 0.04632 |||CIDEr: 0.05855 |||ROUGE_L: 0.2129
03-10 04:21:24-INFO:==>> Model lr: 4.096e-05, Visual Encoder lr: 2.048e-05
03-10 05:24:37-INFO:Epoch [5/30] - results\mimic_cxr\V12_resnet101_labelloss_rankloss_5th_mimic_try_20240310-151749
03-10 05:24:37-INFO:VAL ||| Epoch: 5|||train_loss: 1.825||| BLEU_1: 0.2603 |||BLEU_2: 0.1397 |||BLEU_3: 0.08306 |||BLEU_4: 0.05291 |||CIDEr: 0.04536 |||ROUGE_L: 0.217
03-10 05:24:37-INFO:TEST || Epoch: 5|||train_loss: 1.825||| BLEU_1: 0.2748 |||BLEU_2: 0.151 |||BLEU_3: 0.09091 |||BLEU_4: 0.05868 |||CIDEr: 0.05856 |||ROUGE_L: 0.2194
03-10 05:24:54-INFO:Saving current best: model_best.pth ...
03-10 05:24:54-INFO:==>> Model lr: 3.2768e-05, Visual Encoder lr: 1.6384e-05
03-10 06:28:20-INFO:Epoch [6/30] - results\mimic_cxr\V12_resnet101_labelloss_rankloss_5th_mimic_try_20240310-151749
03-10 06:28:20-INFO:VAL ||| Epoch: 6|||train_loss: 1.794||| BLEU_1: 0.2634 |||BLEU_2: 0.1359 |||BLEU_3: 0.07365 |||BLEU_4: 0.04578 |||CIDEr: 0.04765 |||ROUGE_L: 0.2113
03-10 06:28:20-INFO:TEST || Epoch: 6|||train_loss: 1.794||| BLEU_1: 0.2723 |||BLEU_2: 0.1393 |||BLEU_3: 0.07502 |||BLEU_4: 0.04708 |||CIDEr: 0.06317 |||ROUGE_L: 0.21
03-10 06:28:25-INFO:==>> Model lr: 2.62144e-05, Visual Encoder lr: 1.31072e-05
03-10 07:31:09-INFO:Epoch [7/30] - results\mimic_cxr\V12_resnet101_labelloss_rankloss_5th_mimic_try_20240310-151749
03-10 07:31:09-INFO:VAL ||| Epoch: 7|||train_loss: 1.771||| BLEU_1: 0.2555 |||BLEU_2: 0.134 |||BLEU_3: 0.07558 |||BLEU_4: 0.04782 |||CIDEr: 0.04798 |||ROUGE_L: 0.2125
03-10 07:31:09-INFO:TEST || Epoch: 7|||train_loss: 1.771||| BLEU_1: 0.2677 |||BLEU_2: 0.1403 |||BLEU_3: 0.07879 |||BLEU_4: 0.04993 |||CIDEr: 0.06501 |||ROUGE_L: 0.2132
03-10 07:31:15-INFO:==>> Model lr: 2.097152e-05, Visual Encoder lr: 1.048576e-05
03-10 08:35:39-INFO:Epoch [8/30] - results\mimic_cxr\V12_resnet101_labelloss_rankloss_5th_mimic_try_20240310-151749
03-10 08:35:39-INFO:VAL ||| Epoch: 8|||train_loss: 1.753||| BLEU_1: 0.2602 |||BLEU_2: 0.1396 |||BLEU_3: 0.08297 |||BLEU_4: 0.05287 |||CIDEr: 0.04521 |||ROUGE_L: 0.2168
03-10 08:35:39-INFO:TEST || Epoch: 8|||train_loss: 1.753||| BLEU_1: 0.2746 |||BLEU_2: 0.1507 |||BLEU_3: 0.09063 |||BLEU_4: 0.0585 |||CIDEr: 0.05851 |||ROUGE_L: 0.2192
03-10 08:35:45-INFO:==>> Model lr: 1.677722e-05, Visual Encoder lr: 8.388608e-06
03-10 09:41:19-INFO:Epoch [9/30] - results\mimic_cxr\V12_resnet101_labelloss_rankloss_5th_mimic_try_20240310-151749
03-10 09:41:19-INFO:VAL ||| Epoch: 9|||train_loss: 1.74||| BLEU_1: 0.2555 |||BLEU_2: 0.1335 |||BLEU_3: 0.07461 |||BLEU_4: 0.04678 |||CIDEr: 0.04759 |||ROUGE_L: 0.213
03-10 09:41:19-INFO:TEST || Epoch: 9|||train_loss: 1.74||| BLEU_1: 0.2677 |||BLEU_2: 0.1399 |||BLEU_3: 0.07798 |||BLEU_4: 0.04899 |||CIDEr: 0.06491 |||ROUGE_L: 0.2137
03-10 09:41:25-INFO:==>> Model lr: 1.342177e-05, Visual Encoder lr: 6.710886e-06
03-10 10:53:24-INFO:Epoch [10/30] - results\mimic_cxr\V12_resnet101_labelloss_rankloss_5th_mimic_try_20240310-151749
03-10 10:53:24-INFO:VAL ||| Epoch: 10|||train_loss: 1.729||| BLEU_1: 0.2971 |||BLEU_2: 0.1648 |||BLEU_3: 0.09805 |||BLEU_4: 0.06303 |||CIDEr: 0.0745 |||ROUGE_L: 0.2363
03-10 10:53:24-INFO:TEST || Epoch: 10|||train_loss: 1.729||| BLEU_1: 0.3098 |||BLEU_2: 0.172 |||BLEU_3: 0.1019 |||BLEU_4: 0.06523 |||CIDEr: 0.09924 |||ROUGE_L: 0.2365
03-10 10:53:41-INFO:Saving current best: model_best.pth ...
03-10 10:53:41-INFO:==>> Model lr: 1.073742e-05, Visual Encoder lr: 5.368709e-06
03-10 10:55:49-INFO:=> User Stop!
03-10 10:55:57-INFO:Saved checkpint!
03-10 10:55:57-INFO:
********************Best results********************
03-10 10:55:57-INFO:Best results (w.r.t BLEU_4) in validation set:
03-10 10:55:57-INFO:VAL ||| Epoch: 10|||train_loss: 1.729||| BLEU_1: 0.2971 |||BLEU_2: 0.1648 |||BLEU_3: 0.09805 |||BLEU_4: 0.06303 |||CIDEr: 0.0745 |||ROUGE_L: 0.2363
03-10 10:55:57-INFO:TEST || Epoch: 10|||train_loss: 1.729||| BLEU_1: 0.3098 |||BLEU_2: 0.172 |||BLEU_3: 0.1019 |||BLEU_4: 0.06523 |||CIDEr: 0.09924 |||ROUGE_L: 0.2365
03-10 10:55:57-INFO:Best results (w.r.t BLEU_4) in test set:
03-10 10:55:57-INFO:VAL ||| Epoch: 10|||train_loss: 1.729||| BLEU_1: 0.2971 |||BLEU_2: 0.1648 |||BLEU_3: 0.09805 |||BLEU_4: 0.06303 |||CIDEr: 0.0745 |||ROUGE_L: 0.2363
03-10 10:55:57-INFO:TEST || Epoch: 10|||train_loss: 1.729||| BLEU_1: 0.3098 |||BLEU_2: 0.172 |||BLEU_3: 0.1019 |||BLEU_4: 0.06523 |||CIDEr: 0.09924 |||ROUGE_L: 0.2365
03-10 10:55:58-INFO:Namespace(image_dir='data/mimic/r2gen/images/images224/files', ann_path='data/mimic/r2gen/images/images224/annotation.json', label_path='data/mimic/finding/chexpert_labeled.csv', image_size=256, crop_size=224, dataset_name='mimic_cxr', max_seq_length=80, threshold=3, num_workers=4, batch_size=16, version='12', visual_extractor='resnet101', visual_extractor_pretrained=True, pretrain_cnn_file=None, d_model=512, d_ff=512, d_vf=2048, num_heads=8, num_memory_heads=8, num_layers=3, num_labels=14, dropout=0.1, logit_layers=1, bos_idx=0, eos_idx=0, pad_idx=0, use_bn=0, drop_prob_lm=0.1, sample_method='beam_search', beam_size=3, temperature=1.0, sample_n=1, group_size=1, output_logsoftmax=1, decoding_constraint=0, block_trigrams=1, n_gpu=1, epochs=30, save_dir='results\\mimic_cxr\\V12_resnet101_labelloss_rankloss_5th_mimic_try_20240310-151749', expe_name='5th_mimic_try', record_dir='records/', save_period=1, monitor_mode='max', monitor_metric='BLEU_4', early_stop=50, label_smoothing=0.1, alpha=0.5, grad_clip=5, test_steps=500, label_loss=True, rank_loss=True, optim='Adam', lr_ve=5e-05, lr_ed=0.0001, weight_decay=5e-05, amsgrad=True, lr_scheduler='StepLR', step_size=1, gamma=0.8, seed=456789, gpu='0', resume=None, num_slots=60, rm_num_heads=8, rm_d_model=512, cfg='config/mimic_resnet.yml', set_cfgs=[])
03-29 21:02:13-INFO:Logging Dir: D:\Py\M2KT\results\mimic_cxr\V12_resnet101_labelloss_rankloss_5th_mimic_try_20240310-151749
03-29 21:02:13-INFO:Visual Extractor:resnet101   d_vf: 2048
03-29 21:02:13-INFO:==>> Set GPU devices: 0
03-29 21:02:13-INFO:Namespace(image_dir='data/iu_xray/images/', ann_path='data/iu_xray/annotation.json', label_path='/home/shuxinyang/data/mimic/finding/chexpert_labeled.csv', image_size=256, crop_size=224, dataset_name='iu_xray', max_seq_length=60, threshold=3, num_workers=4, batch_size=16, version='0', visual_extractor='resnet101', visual_extractor_pretrained=True, pretrain_cnn_file='', d_model=512, d_ff=512, d_vf=2048, num_heads=8, num_memory_heads=8, num_layers=6, num_labels=14, dropout=0.1, logit_layers=1, bos_idx=0, eos_idx=0, pad_idx=0, use_bn=0, drop_prob_lm=0.1, sample_method='beam_search', beam_size=3, temperature=1.0, sample_n=1, group_size=1, output_logsoftmax=1, decoding_constraint=0, block_trigrams=1, n_gpu=1, epochs=100, save_dir='D:\\Py\\M2KT\\results\\mimic_cxr\\V12_resnet101_labelloss_rankloss_5th_mimic_try_20240310-151749', expe_name='', record_dir='records/', save_period=1, monitor_mode='max', monitor_metric='BLEU_4', early_stop=50, label_smoothing=0.0, alpha=0.5, grad_clip=5, test_steps=0, label_loss=False, rank_loss=False, optim='Adam', lr_ve=5e-05, lr_ed=0.0001, weight_decay=5e-05, amsgrad=True, lr_scheduler='StepLR', step_size=20, gamma=0.1, seed=9233, gpu='0', resume='D:\\Py\\M2KT\\results\\mimic_cxr\\V12_resnet101_labelloss_rankloss_5th_mimic_try_20240310-151749\\current_checkpoint.pth', num_slots=60, rm_num_heads=8, rm_d_model=512, cfg=None, set_cfgs=[])
03-29 21:02:55-INFO:Logging Dir: D:\Py\M2KT\results\mimic_cxr\V12_resnet101_labelloss_rankloss_5th_mimic_try_20240310-151749
03-29 21:02:55-INFO:Visual Extractor:resnet101   d_vf: 2048
03-29 21:02:55-INFO:==>> Set GPU devices: 0
03-29 21:02:55-INFO:Namespace(image_dir='data/iu_xray/images/', ann_path='data/iu_xray/annotation.json', label_path='/home/shuxinyang/data/mimic/finding/chexpert_labeled.csv', image_size=256, crop_size=224, dataset_name='iu_xray', max_seq_length=60, threshold=3, num_workers=4, batch_size=16, version='0', visual_extractor='resnet101', visual_extractor_pretrained=True, pretrain_cnn_file='', d_model=512, d_ff=512, d_vf=2048, num_heads=8, num_memory_heads=8, num_layers=6, num_labels=14, dropout=0.1, logit_layers=1, bos_idx=0, eos_idx=0, pad_idx=0, use_bn=0, drop_prob_lm=0.1, sample_method='beam_search', beam_size=3, temperature=1.0, sample_n=1, group_size=1, output_logsoftmax=1, decoding_constraint=0, block_trigrams=1, n_gpu=1, epochs=100, save_dir='D:\\Py\\M2KT\\results\\mimic_cxr\\V12_resnet101_labelloss_rankloss_5th_mimic_try_20240310-151749', expe_name='', record_dir='records/', save_period=1, monitor_mode='max', monitor_metric='BLEU_4', early_stop=50, label_smoothing=0.0, alpha=0.5, grad_clip=5, test_steps=0, label_loss=False, rank_loss=False, optim='Adam', lr_ve=5e-05, lr_ed=0.0001, weight_decay=5e-05, amsgrad=True, lr_scheduler='StepLR', step_size=20, gamma=0.1, seed=9233, gpu='0', resume='D:\\Py\\M2KT\\results\\mimic_cxr\\V12_resnet101_labelloss_rankloss_5th_mimic_try_20240310-151749\\interrupt_checkpoint.pth', num_slots=60, rm_num_heads=8, rm_d_model=512, cfg=None, set_cfgs=[])
03-29 21:03:52-INFO:Logging Dir: D:\Py\M2KT\results\mimic_cxr\V12_resnet101_labelloss_rankloss_5th_mimic_try_20240310-151749
03-29 21:03:52-INFO:Visual Extractor:resnet101   d_vf: 2048
03-29 21:03:52-INFO:==>> Set GPU devices: 0
03-29 21:03:52-INFO:Namespace(image_dir='data/mimic/r2gen/images/images224/files', ann_path='data/mimic/r2gen/images/images224/annotation.json', label_path='data/mimic/finding/chexpert_labeled.csv', image_size=256, crop_size=224, dataset_name='mimic_cxr', max_seq_length=80, threshold=3, num_workers=4, batch_size=16, version='0', visual_extractor='resnet101', visual_extractor_pretrained=True, pretrain_cnn_file=None, d_model=512, d_ff=512, d_vf=2048, num_heads=8, num_memory_heads=8, num_layers=3, num_labels=14, dropout=0.1, logit_layers=1, bos_idx=0, eos_idx=0, pad_idx=0, use_bn=0, drop_prob_lm=0.1, sample_method='beam_search', beam_size=3, temperature=1.0, sample_n=1, group_size=1, output_logsoftmax=1, decoding_constraint=0, block_trigrams=1, n_gpu=1, epochs=30, save_dir='D:\\Py\\M2KT\\results\\mimic_cxr\\V12_resnet101_labelloss_rankloss_5th_mimic_try_20240310-151749', expe_name='', record_dir='records/', save_period=1, monitor_mode='max', monitor_metric='BLEU_4', early_stop=50, label_smoothing=0.1, alpha=0.5, grad_clip=5, test_steps=500, label_loss=False, rank_loss=False, optim='Adam', lr_ve=5e-05, lr_ed=0.0001, weight_decay=5e-05, amsgrad=True, lr_scheduler='StepLR', step_size=1, gamma=0.8, seed=456789, gpu='0', resume='D:\\Py\\M2KT\\results\\mimic_cxr\\V12_resnet101_labelloss_rankloss_5th_mimic_try_20240310-151749\\interrupt_checkpoint.pth', num_slots=60, rm_num_heads=8, rm_d_model=512, cfg='config/mimic_resnet.yml', set_cfgs=[])
03-29 21:04:13-INFO:Model name: LAMRGModel_v0 	Model Layers:3
03-29 21:05:16-INFO:Logging Dir: D:\Py\M2KT\results\mimic_cxr\V12_resnet101_labelloss_rankloss_5th_mimic_try_20240310-151749
03-29 21:05:16-INFO:Visual Extractor:resnet101   d_vf: 2048
03-29 21:05:16-INFO:==>> Set GPU devices: 0
03-29 21:05:16-INFO:Namespace(image_dir='data/mimic/r2gen/images/images224/files', ann_path='data/mimic/r2gen/images/images224/annotation.json', label_path='data/mimic/finding/chexpert_labeled.csv', image_size=256, crop_size=224, dataset_name='mimic_cxr', max_seq_length=80, threshold=3, num_workers=4, batch_size=16, version='12', visual_extractor='resnet101', visual_extractor_pretrained=True, pretrain_cnn_file=None, d_model=512, d_ff=512, d_vf=2048, num_heads=8, num_memory_heads=8, num_layers=3, num_labels=14, dropout=0.1, logit_layers=1, bos_idx=0, eos_idx=0, pad_idx=0, use_bn=0, drop_prob_lm=0.1, sample_method='beam_search', beam_size=3, temperature=1.0, sample_n=1, group_size=1, output_logsoftmax=1, decoding_constraint=0, block_trigrams=1, n_gpu=1, epochs=30, save_dir='D:\\Py\\M2KT\\results\\mimic_cxr\\V12_resnet101_labelloss_rankloss_5th_mimic_try_20240310-151749', expe_name='', record_dir='records/', save_period=1, monitor_mode='max', monitor_metric='BLEU_4', early_stop=50, label_smoothing=0.1, alpha=0.5, grad_clip=5, test_steps=500, label_loss=True, rank_loss=True, optim='Adam', lr_ve=5e-05, lr_ed=0.0001, weight_decay=5e-05, amsgrad=True, lr_scheduler='StepLR', step_size=1, gamma=0.8, seed=456789, gpu='0', resume='D:\\Py\\M2KT\\results\\mimic_cxr\\V12_resnet101_labelloss_rankloss_5th_mimic_try_20240310-151749\\interrupt_checkpoint.pth', num_slots=60, rm_num_heads=8, rm_d_model=512, cfg='config/mimic_resnet.yml', set_cfgs=[])
03-29 21:05:35-INFO:Model name: LAMRGModel_v12 	Model Layers:3
03-29 21:05:49-INFO:Loading checkpoint: D:\Py\M2KT\results\mimic_cxr\V12_resnet101_labelloss_rankloss_5th_mimic_try_20240310-151749\interrupt_checkpoint.pth ...
